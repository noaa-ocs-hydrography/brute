<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>

    <title>autointerp &#8212; autointerp documentation</title>

    <link href="../_static/classic.css" rel="stylesheet" type="text/css"/>
    <link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };



    </script>
    <script src="../_static/jquery.js" type="text/javascript"></script>
    <script src="../_static/underscore.js" type="text/javascript"></script>
    <script src="../_static/doctools.js" type="text/javascript"></script>
    <link href="../genindex.html" rel="index" title="Index"/>
    <link href="../search.html" rel="search" title="Search"/>
</head>
<body role="document">
<div aria-label="related navigation" class="related" role="navigation">
    <h3>Navigation</h3>
    <ul>
        <li class="right" style="margin-right: 10px">
            <a accesskey="I" href="../genindex.html"
               title="General Index">index</a></li>
        <li class="right">
            <a href="../py-modindex.html" title="Python Module Index"
            >modules</a> |
        </li>
        <li class="nav-item nav-item-0"><a href="../index.html">autointerp documentation</a> &#187;</li>
        <li class="nav-item nav-item-1"><a accesskey="U" href="index.html">Module code</a> &#187;</li>
    </ul>
</div>

<div class="document">
    <div class="documentwrapper">
        <div class="bodywrapper">
            <div class="body" role="main">

                <h1>Source code for autointerp</h1>
                <div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Thu Oct 11 16:52:49 2018</span>

<span class="sd">@author: Casiano.Koprowski</span>

<span class="sd">Made in part with code from:</span>
<span class="sd">    - hyo.bag Library Pydro by HydrOffice</span>
<span class="sd">    - &quot;What is the simplest way...&quot; on GIS Stack Exchange [Answer by &#39;Jon&#39;</span>
<span class="sd">        (https://gis.stackexchange.com/a/278965)]</span>
<span class="sd">    - &quot;How to get raster corner...&quot; on on GIS Stack Exchange [Answer by &#39;James&#39;</span>
<span class="sd">        (https://gis.stackexchange.com/a/201320)]</span>

<span class="sd">Icon from https://www.ngdc.noaa.gov/mgg/image/2minrelief.html</span>
<span class="sd">    via https://commons.wikimedia.org/wiki/File:Atlantic_bathymetry.jpg</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span> <span class="k">as</span> <span class="nn">_os</span>
<span class="kn">import</span> <span class="nn">re</span> <span class="k">as</span> <span class="nn">_re</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">_np</span>
<span class="kn">import</span> <span class="nn">tables</span> <span class="k">as</span> <span class="nn">_tb</span>
<span class="kn">import</span> <span class="nn">time</span> <span class="k">as</span> <span class="nn">_time</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">_scipy</span>
<span class="kn">import</span> <span class="nn">shutil</span> <span class="k">as</span> <span class="nn">_shutil</span>
<span class="kn">import</span> <span class="nn">lxml.etree</span> <span class="k">as</span> <span class="nn">_et</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span
                        class="nn">_plt</span>
<span class="kn">import</span> <span class="nn">astropy.convolution</span> <span class="k">as</span> <span class="nn">_apc</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span
                        class="n">datetime</span> <span class="k">as</span> <span class="n">_dt</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="k">import</span> <span class="n">ascii_lowercase</span> <span
                        class="k">as</span> <span class="n">_al</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage.interpolation</span> <span class="k">import</span> <span
                        class="n">zoom</span> <span class="k">as</span> <span class="n">_zoom</span>

<span class="kn">from</span> <span class="nn">osgeo</span> <span class="k">import</span> <span
                        class="n">gdal</span> <span class="k">as</span> <span class="n">_gdal</span>
<span class="kn">from</span> <span class="nn">osgeo</span> <span class="k">import</span> <span
                        class="n">ogr</span> <span class="k">as</span> <span class="n">_ogr</span>
<span class="kn">from</span> <span class="nn">osgeo</span> <span class="k">import</span> <span
                        class="n">osr</span> <span class="k">as</span> <span class="n">_osr</span>
<span class="kn">from</span> <span class="nn">osgeo</span> <span class="k">import</span> <span
                        class="n">gdalconst</span> <span class="k">as</span> <span class="n">_gdalconst</span>

<span class="c1">#import autointerp_ui</span>

<span class="c1"># this allows GDAL to throw Python Exceptions</span>
<span class="n">_gdal</span><span class="o">.</span><span class="n">UseExceptions</span><span class="p">()</span>

<span class="n">progLoc</span> <span class="o">=</span> <span class="n">_os</span><span class="o">.</span><span
                        class="n">getcwd</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">progLoc</span><span class="p">)</span>

<span class="n">ns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;bag&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.opennavsurf.org/schema/bag&#39;</span><span
                        class="p">,</span>
    <span class="s1">&#39;gco&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.isotc211.org/2005/gco&#39;</span><span
                        class="p">,</span>
    <span class="s1">&#39;gmd&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.isotc211.org/2005/gmd&#39;</span><span
                        class="p">,</span>
    <span class="s1">&#39;gmi&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.isotc211.org/2005/gmi&#39;</span><span
                        class="p">,</span>
    <span class="s1">&#39;gml&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.opengis.net/gml/3.2&#39;</span><span
                        class="p">,</span>
    <span class="s1">&#39;xsi&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.w3.org/2001/XMLSchema-instance&#39;</span><span
                        class="p">,</span>
<span class="p">}</span>

<span class="n">ns2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;gml&#39;</span><span class="p">:</span> <span
                        class="s1">&#39;http://www.opengis.net/gml&#39;</span><span class="p">,</span>
    <span class="s1">&#39;xsi&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.w3.org/2001/XMLSchema-instance&#39;</span><span
                        class="p">,</span>
    <span class="s1">&#39;smXML&#39;</span><span class="p">:</span> <span class="s1">&#39;http://metadata.dgiwg.org/smXML&#39;</span><span
                        class="p">,</span>
<span class="p">}</span>

<span class="n">catZones</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;A1&#39;</span><span class="p">:[</span><span class="o">.</span><span
                        class="mi">01</span><span class="p">,</span><span class="o">.</span><span
                        class="mi">5</span><span class="p">],</span>
        <span class="s1">&#39;A2/B&#39;</span><span class="p">:[</span><span class="o">.</span><span
                        class="mi">02</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="o">.</span><span
                        class="mi">05</span><span class="p">,</span><span class="mi">2</span><span class="p">]}</span>

<span class="n">combo</span> <span class="o">=</span> <span class="n">_re</span><span class="o">.</span><span class="n">compile</span><span
                        class="p">(</span><span class="sa">r</span><span class="s1">&#39;COMBINED&#39;</span><span
                        class="p">,</span> <span class="n">_re</span><span class="o">.</span><span
                        class="n">IGNORECASE</span><span class="p">)</span>
<span class="n">interp</span> <span class="o">=</span> <span class="n">_re</span><span class="o">.</span><span
                        class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;INTERP&#39;</span><span
                        class="p">,</span> <span class="n">_re</span><span class="o">.</span><span
                        class="n">IGNORECASE</span><span class="p">)</span>

<div class="viewcode-block" id="getTifElev"><a class="viewcode-back"
                                               href="../index.html#autointerp.getTifElev">[docs]</a><span
        class="k">def</span> <span class="nf">getTifElev</span><span class="p">(</span><span class="n">files</span><span
        class="p">):</span>
    <span class="sd">&#39;&#39;&#39;This function takes a list of GeoTiff filepaths and opens each in order</span>
<span class="sd">    to access their values. Returned as a list of tif objects are the order a</span>
<span class="sd">    file was found, the path of the file, and the file&#39;s values as</span>
<span class="sd">    [x, file, extent, arr] and a list of file names</span>

<span class="sd">    Upper Left Corner and Lower Right Corner Bounds Directly from:</span>
<span class="sd">    &quot;How to get raster corner...&quot; on on GIS Stack Exchange [Answer by &#39;James&#39;</span>
<span class="sd">    (https://gis.stackexchange.com/a/201320)]</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    files : list</span>
<span class="sd">        File paths of the input GeoTiff files</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tifFiles : list</span>
<span class="sd">        List of GeoTiff file objects</span>
<span class="sd">        Position loaded, file name, raster extents, numpy.array</span>
<span class="sd">    names : list</span>
<span class="sd">        list of names of imported GeoTiffs</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;getTifElev&#39;</span><span
            class="p">)</span>
    <span class="n">tifFiles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">maxVal</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span
            class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">_gdal</span><span class="o">.</span><span
            class="n">Open</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="c1">#        print (_gdal.Info(ds))</span>
        <span class="n">ulx</span><span class="p">,</span> <span class="n">xres</span><span class="p">,</span> <span
            class="n">xskew</span><span class="p">,</span> <span class="n">uly</span><span class="p">,</span> <span
            class="n">yskew</span><span class="p">,</span> <span class="n">yres</span>  <span class="o">=</span> <span
            class="n">ds</span><span class="o">.</span><span class="n">GetGeoTransform</span><span class="p">()</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">xres</span><span class="p">,</span> <span
            class="n">yres</span><span class="p">)</span>
        <span class="n">lrx</span> <span class="o">=</span> <span class="n">ulx</span> <span class="o">+</span> <span
            class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">RasterXSize</span> <span
            class="o">*</span> <span class="n">xres</span><span class="p">)</span>
        <span class="n">lry</span> <span class="o">=</span> <span class="n">uly</span> <span class="o">+</span> <span
            class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">RasterYSize</span> <span
            class="o">*</span> <span class="n">yres</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">ulx</span><span class="p">,</span> <span
            class="n">lrx</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">uly</span><span class="p">,</span> <span
            class="n">lry</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lrx</span><span class="o">&lt;</span><span class="n">ulx</span><span
            class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">ulx</span>
            <span class="n">ulx</span> <span class="o">=</span> <span class="n">lrx</span>
            <span class="n">lrx</span> <span class="o">=</span> <span class="n">s</span>
        <span class="k">if</span> <span class="n">uly</span><span class="o">&lt;</span><span class="n">lry</span><span
            class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">lry</span>
            <span class="n">lry</span> <span class="o">=</span> <span class="n">uly</span>
            <span class="n">uly</span> <span class="o">=</span> <span class="n">s</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="p">([</span><span class="n">ulx</span><span
            class="p">,</span> <span class="n">uly</span><span class="p">],</span> <span class="p">[</span><span
            class="n">lrx</span><span class="p">,</span> <span class="n">lry</span><span class="p">])</span>

        <span class="n">fName</span> <span class="o">=</span> <span class="n">_os</span><span class="o">.</span><span
            class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span
            class="n">file</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]</span>
        <span class="n">splits</span> <span class="o">=</span> <span class="n">fName</span><span class="o">.</span><span
            class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span
            class="n">join</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span
            class="n">x</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">[:</span><span
            class="mi">2</span><span class="p">]])</span>
        <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
            class="n">name</span><span class="p">)</span>
        <span class="n">band</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span
            class="n">GetRasterBand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">band</span><span class="o">.</span><span
            class="n">ReadAsArray</span><span class="p">()</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="n">maxVal</span> <span class="o">=</span> <span class="n">maxValue</span><span
            class="p">(</span><span class="n">arr</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">maxVal</span><span class="p">)</span>
        <span class="p">[</span><span class="n">cols</span><span class="p">,</span> <span class="n">rows</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span
            class="n">shape</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span
            class="n">shape</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">_np</span><span class="o">.</span><span
            class="n">amax</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span
            class="n">_np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span
            class="n">arr</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">meta</span><span class="p">)</span>
        <span class="n">band</span><span class="o">=</span><span class="kc">None</span>
        <span class="n">ds</span><span class="o">=</span><span class="kc">None</span>
        <span class="n">tifFiles</span><span class="o">.</span><span class="n">append</span> <span
            class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">file</span><span
            class="p">,</span> <span class="n">meta</span><span class="p">,</span> <span class="n">arr</span><span
            class="p">])</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">tifFiles</span><span class="p">,</span> <span
            class="n">names</span></div>


<div class="viewcode-block" id="getBagLyrs"><a class="viewcode-back"
                                               href="../index.html#autointerp.getBagLyrs">[docs]</a><span
        class="k">def</span> <span class="nf">getBagLyrs</span><span class="p">(</span><span
        class="n">fileObj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function takes a list of BAG filepaths and opens each in order</span>
<span class="sd">    to access their values. Returned is a list of bag objects are the order a</span>
<span class="sd">    file was found, the path of the file, the file&#39;s elevation values, and the</span>
<span class="sd">    file&#39;s uncertainty values as [x, file, extent, elev] and a list of file</span>
<span class="sd">    names</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    files : string</span>
<span class="sd">        File path of the input BAG file</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bag : list</span>
<span class="sd">        BAG file object</span>
<span class="sd">        Position loaded, file name, grid extents, file size, grid dimensions,</span>
<span class="sd">        uncertainty numpy.array, bathymetry numpy.array</span>
<span class="sd">    maxVal : int</span>
<span class="sd">        Maximum occurance value AKA nodata value</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;getBagLyrs&#39;</span><span
            class="p">)</span>
<span class="c1">#    bagFiles = []</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">fileObj</span><span class="p">)</span>
    <span class="n">fName</span> <span class="o">=</span> <span class="n">_os</span><span class="o">.</span><span
            class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span
            class="n">fileObj</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]</span>
    <span class="n">splits</span> <span class="o">=</span> <span class="n">fName</span><span class="o">.</span><span
            class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span
            class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span> <span
            class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">splits</span><span
            class="p">[:</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
            class="n">name</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">splits</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
            class="n">_np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span
            class="n">_os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span
            class="n">getsize</span><span class="p">(</span><span class="n">fileObj</span><span class="p">)</span><span
            class="o">/</span><span class="mi">1000</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">_tb</span><span class="o">.</span><span class="n">open_file</span><span
            class="p">(</span><span class="n">fileObj</span><span class="p">,</span> <span class="n">mode</span> <span
            class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span
            class="k">as</span> <span class="n">bagfile</span><span class="p">:</span>
        <span class="n">meta_read</span> <span class="o">=</span> <span class="p">[</span><span
            class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span
            class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span
            class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span
            class="n">bagfile</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span
            class="n">BAG_root</span><span class="o">.</span><span class="n">metadata</span><span
            class="o">.</span><span class="n">read</span><span class="p">()]</span>
<span class="c1">#        print (meta_read)</span>
        <span class="n">meta_xml</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span
            class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">meta_read</span><span
            class="p">)</span>
<span class="c1">#        print (meta_xml)</span>
        <span class="n">encodeVal</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span
            class="n">meta_xml</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">meta_xml</span><span class="p">[</span><span
            class="n">encodeVal</span><span class="p">]</span> <span class="o">==</span> <span
            class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
                <span class="n">meta_xml</span> <span class="o">=</span> <span class="n">meta_xml</span><span class="p">[</span><span
            class="n">encodeVal</span><span class="p">:]</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">encodeVal</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">startVal</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span
            class="n">meta_xml</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">meta_xml</span><span class="p">[</span><span
            class="n">startVal</span><span class="p">]</span> <span class="o">==</span> <span
            class="s1">&#39;&lt;&#39;</span><span class="p">:</span>
                <span class="n">meta_xml</span> <span class="o">=</span> <span class="n">meta_xml</span><span class="p">[</span><span
            class="n">startVal</span><span class="p">:]</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">startVal</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">xml_tree</span> <span class="o">=</span> <span class="n">_et</span><span class="o">.</span><span
            class="n">XML</span><span class="p">(</span><span class="n">meta_xml</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">xml_tree</span><span
            class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//*/gmd:spatialRepresentationInfo/gmd:MD_Georectified/&#39;</span>
                                      <span class="s1">&#39;gmd:cornerPoints/gml:Point/gml:coordinates&#39;</span><span
            class="p">,</span>
                                      <span class="n">namespaces</span><span class="o">=</span><span class="n">ns</span><span
            class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span
            class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">_et</span><span class="o">.</span><span
            class="n">Error</span><span class="p">,</span> <span class="ne">IndexError</span><span
            class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">xml_tree</span><span
            class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//*/spatialRepresentationInfo/smXML:MD_Georectified/&#39;</span>
                                          <span class="s1">&#39;cornerPoints/gml:Point/gml:coordinates&#39;</span><span
            class="p">,</span>
                                          <span class="n">namespaces</span><span class="o">=</span><span
            class="n">ns2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span
            class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span
            class="p">()</span>
                <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">_et</span><span
            class="o">.</span><span class="n">Error</span><span class="p">,</span> <span
            class="ne">IndexError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span
            class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unable to read corners SW and NE: </span><span
            class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span><span
            class="p">)</span>
                <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">sw</span> <span class="o">=</span> <span class="p">[</span><span
            class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span
            class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ret</span><span
            class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span
            class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
            <span class="n">ne</span> <span class="o">=</span> <span class="p">[</span><span
            class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span
            class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ret</span><span
            class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span
            class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span
            class="ne">IndexError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span
            class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;unable to read corners SW and NE: </span><span
            class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span><span
            class="p">)</span>
            <span class="k">return</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span
            class="n">ret</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span
            class="n">ne</span><span class="p">)</span>
        <span class="n">sx</span><span class="p">,</span><span class="n">sy</span> <span class="o">=</span> <span
            class="n">sw</span>
        <span class="n">nx</span><span class="p">,</span><span class="n">ny</span> <span class="o">=</span> <span
            class="n">ne</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="p">[[</span><span class="n">sx</span><span
            class="p">,</span><span class="n">ny</span><span class="p">],[</span><span class="n">nx</span><span
            class="p">,</span><span class="n">sy</span><span class="p">]]</span>
        <span class="n">elev</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">flipud</span><span class="p">(</span><span class="n">bagfile</span><span class="o">.</span><span
            class="n">root</span><span class="o">.</span><span class="n">BAG_root</span><span class="o">.</span><span
            class="n">elevation</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">uncr</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">flipud</span><span class="p">(</span><span class="n">bagfile</span><span class="o">.</span><span
            class="n">root</span><span class="o">.</span><span class="n">BAG_root</span><span class="o">.</span><span
            class="n">uncertainty</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">elev</span><span class="o">.</span><span
            class="n">shape</span>
<span class="c1">#        maxVal = _np.amax(elev)</span>
        <span class="n">maxVal</span> <span class="o">=</span> <span class="mf">1000000.0</span>
        <span class="n">bag</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span
            class="p">,</span> <span class="n">fileObj</span><span class="p">,</span> <span class="n">meta</span><span
            class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">shape</span><span
            class="p">,</span> <span class="n">uncr</span><span class="p">,</span> <span class="n">elev</span><span
            class="p">]</span>
<span class="c1">#        bag = [y, fileObj, meta, size, shape]</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">bag</span><span class="p">,</span> <span
            class="n">maxVal</span><span class="p">)</span>
        <span class="n">bagfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">bag</span><span class="p">,</span> <span class="n">maxVal</span><span
            class="p">,</span> <span class="n">bagfile</span></div>

<div class="viewcode-block" id="getShpRast"><a class="viewcode-back"
                                               href="../index.html#autointerp.getShpRast">[docs]</a><span
        class="k">def</span> <span class="nf">getShpRast</span><span class="p">(</span><span class="n">file</span><span
        class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Import shapefile</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file : string</span>
<span class="sd">        Shapefile file location</span>

<span class="sd">    Todo</span>
<span class="sd">    ----</span>
<span class="sd">    Inital working idea for importing shapefiles as rasters</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;getShpRast&#39;</span><span
            class="p">)</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">_ogr</span><span class="o">.</span><span
            class="n">Open</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span
            class="n">GetLayer</span><span class="p">()</span>
    <span class="n">fnum</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span
            class="n">GetFeatureCount</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span class="n">arrange</span><span
            class="p">(</span><span class="n">fnum</span><span class="p">)</span>
    <span class="n">polys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span> <span
            class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span
            class="n">_np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span
            class="n">fnum</span><span class="p">)):</span>
        <span class="n">polys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
            class="n">shape</span><span class="o">.</span><span class="n">GetFeature</span><span class="p">(</span><span
            class="n">n</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">polys</span><span class="p">)</span></div>

<div class="viewcode-block" id="write_raster"><a class="viewcode-back" href="../index.html#autointerp.write_raster">[docs]</a><span
        class="k">def</span> <span class="nf">write_raster</span><span class="p">(</span><span
        class="n">raster_array</span><span class="p">,</span> <span class="n">gt</span><span class="p">,</span> <span
        class="n">data_obj</span><span class="p">,</span> <span class="n">outputpath</span><span
        class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">_gdal</span><span
        class="o">.</span><span class="n">GDT_UInt32</span><span class="p">,</span>
                 <span class="n">options</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span
            class="n">color_table</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span
            class="n">nbands</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span
            class="n">nodata</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Directly From:</span>
<span class="sd">    &quot;What is the simplest way...&quot; on GIS Stack Exchange [Answer by &#39;Jon&#39;</span>
<span class="sd">    (https://gis.stackexchange.com/a/278965)]</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    raster_array : numpy.array</span>
<span class="sd">        Array to be written to a GeoTiff file</span>
<span class="sd">    gt : tuple, gdal.GeoTransform</span>
<span class="sd">        Norhtern extent, resolution, 0.0, Western extent, 0.0, -resolution)</span>
<span class="sd">    data_obj : gdal.RasterBand</span>
<span class="sd">        gdal.RasterBand</span>
<span class="sd">    outputpath : string</span>
<span class="sd">        Folder to save the GeoTiff raster</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;write_raster&#39;</span><span
            class="p">)</span>

    <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span
            class="n">raster_array</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># Prepare destination file</span>
    <span class="n">driver</span> <span class="o">=</span> <span class="n">_gdal</span><span class="o">.</span><span
            class="n">GetDriverByName</span><span class="p">(</span><span class="s2">&quot;GTiff&quot;</span><span
            class="p">)</span>
    <span class="k">if</span> <span class="n">options</span> <span class="o">!=</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="n">dest</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span
            class="n">Create</span><span class="p">(</span><span class="n">outputpath</span><span
            class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span
            class="p">,</span> <span class="n">nbands</span><span class="p">,</span> <span class="n">dtype</span><span
            class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dest</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span
            class="n">Create</span><span class="p">(</span><span class="n">outputpath</span><span
            class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span
            class="p">,</span> <span class="n">nbands</span><span class="p">,</span> <span class="n">dtype</span><span
            class="p">)</span>

    <span class="c1"># Write output raster</span>
    <span class="k">if</span> <span class="n">color_table</span> <span class="o">!=</span> <span
            class="mi">0</span><span class="p">:</span>
        <span class="n">dest</span><span class="o">.</span><span class="n">GetRasterBand</span><span
            class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">SetColorTable</span><span
            class="p">(</span><span class="n">color_table</span><span class="p">)</span>

    <span class="n">dest</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span
            class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">WriteArray</span><span
            class="p">(</span><span class="n">raster_array</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">nodata</span> <span class="ow">is</span> <span class="ow">not</span> <span
            class="kc">False</span><span class="p">:</span>
        <span class="n">dest</span><span class="o">.</span><span class="n">GetRasterBand</span><span
            class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">SetNoDataValue</span><span
            class="p">(</span><span class="n">nodata</span><span class="p">)</span>

    <span class="c1"># Set transform and projection</span>
    <span class="n">dest</span><span class="o">.</span><span class="n">SetGeoTransform</span><span
            class="p">(</span><span class="n">gt</span><span class="p">)</span>
    <span class="n">wkt</span> <span class="o">=</span> <span class="n">data_obj</span><span class="o">.</span><span
            class="n">GetProjection</span><span class="p">()</span>
    <span class="n">srs</span> <span class="o">=</span> <span class="n">_osr</span><span class="o">.</span><span
            class="n">SpatialReference</span><span class="p">()</span>
    <span class="n">srs</span><span class="o">.</span><span class="n">ImportFromWkt</span><span class="p">(</span><span
            class="n">wkt</span><span class="p">)</span>
    <span class="n">dest</span><span class="o">.</span><span class="n">SetProjection</span><span class="p">(</span><span
            class="n">srs</span><span class="o">.</span><span class="n">ExportToWkt</span><span class="p">())</span>

    <span class="c1"># Close output raster dataset</span>
    <span class="n">dest</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="maxValue"><a class="viewcode-back"
                                             href="../index.html#autointerp.maxValue">[docs]</a><span
        class="k">def</span> <span class="nf">maxValue</span><span class="p">(</span><span class="n">arr</span><span
        class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the most used value in the array as an integer</span>

<span class="sd">    Takes an input array and finds the most used value in the array, this</span>
<span class="sd">    value is used by the program to assume the array&#39;s nodata value</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arr : numpy.array</span>
<span class="sd">        An input array</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    maxVal : int</span>
<span class="sd">        Returns the most used value in the array as an integer</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;maxValue&#39;</span><span
            class="p">)</span>
    <span class="n">nums</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span
            class="n">_np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span
            class="n">arr</span><span class="p">,</span> <span class="n">return_counts</span> <span
            class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">where</span><span class="p">(</span><span class="n">counts</span><span class="o">==</span><span
            class="n">_np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span
            class="n">counts</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span
            class="n">nums</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span
            class="p">[</span><span class="n">index</span><span class="p">])</span></div>


<div class="viewcode-block" id="tupleGrid"><a class="viewcode-back" href="../index.html#autointerp.tupleGrid">[docs]</a><span
        class="k">def</span> <span class="nf">tupleGrid</span><span class="p">(</span><span class="n">grid</span><span
        class="p">,</span> <span class="n">maxVal</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes an input matrix and an assumed nodata value. The function iterates</span>
<span class="sd">    through the matrix and compiles a list of &#39;edge&#39; points [[x, y, z], ...]</span>
<span class="sd">    where:</span>

<span class="sd">    1. the current value is not a nodata value and previous value was a nodata value.</span>

<span class="sd">        - sets io True, indicating that the next value to compare against should be a nodata value.</span>

<span class="sd">    2. the current value is a nodata value and the previous value was not a nodata value.</span>

<span class="sd">        - sets io False, indicating that the next value to compare against should not be a nodata value.</span>

<span class="sd">    3. returns a list of the points found.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    grid : numpy.array</span>
<span class="sd">        An input array</span>
<span class="sd">    maxVal : int</span>
<span class="sd">        The array&#39;s nodata value</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.array</span>
<span class="sd">        Array of indecies where nodata values meet data values</span>
<span class="sd">        in order x, y, z</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;tupleGrid&#39;</span><span
            class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span
            class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span
            class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">io</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span
            class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">grid</span><span class="p">[</span><span class="n">y</span><span
            class="p">,</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span
            class="n">maxVal</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">grid</span><span class="p">[</span><span
            class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span
            class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">maxVal</span><span
            class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">grid</span><span
            class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span
            class="p">,</span><span class="n">x</span><span class="p">]</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mi">1</span><span
            class="p">,</span> <span class="n">val</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span
            class="mi">1</span><span class="p">:</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="n">point</span><span
            class="p">,</span> <span class="n">val</span><span class="p">)</span>
                        <span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span
            class="p">(</span><span class="n">point</span><span class="p">)</span>
                    <span class="n">io</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">io</span> <span class="o">==</span> <span
            class="kc">False</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">grid</span><span
            class="p">[</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span
            class="p">]</span>
                    <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span
            class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">val</span><span
            class="p">]</span>

                    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span
            class="mi">0</span><span class="p">:</span>
                        <span class="nb">print</span> <span class="p">(</span><span class="n">point</span><span
            class="p">,</span> <span class="n">val</span><span class="p">)</span>
                        <span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span
            class="p">(</span><span class="n">point</span><span class="p">)</span>
                    <span class="n">io</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">_np</span><span class="o">.</span><span class="n">array</span><span
            class="p">(</span><span class="n">points</span><span class="p">)</span></div>

<div class="viewcode-block" id="concatGrid"><a class="viewcode-back"
                                               href="../index.html#autointerp.concatGrid">[docs]</a><span
        class="k">def</span> <span class="nf">concatGrid</span><span class="p">(</span><span class="n">grids</span><span
        class="p">,</span> <span class="n">maxVal</span><span class="p">,</span> <span class="n">shape</span><span
        class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes an input of an array of grid objects and the assumed nodata value</span>
<span class="sd">    Passes the assumed nodata value and the arrays held within each of the</span>
<span class="sd">    listed grid objects to tupleGrid(grid, maxVal) for a return of an array of</span>
<span class="sd">    edge points for each grid [[x, y, z], ...]</span>

<span class="sd">    Takes the results of both tupleGrid calls and combines them into a single</span>
<span class="sd">    array of edge points.  Then uses .view().sort() to sort the combined</span>
<span class="sd">    products [[x, y, z], ...] based on ascending x, then column y.</span>

<span class="sd">    The results of the sorted point array are then split into a list of points</span>
<span class="sd">    [[x, y], ...] and values [[z], ...] and returned</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    grids : list</span>
<span class="sd">        The BAG and GeoTiff objects</span>
<span class="sd">    maxVal : int</span>
<span class="sd">        The BAG data&#39;s nodata value</span>
<span class="sd">    shape : tuple</span>
<span class="sd">        Dimensions of the input BAG data (y, x)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    grid : numpy.array</span>
<span class="sd">        Array of indecies where nodata values meet data values</span>
<span class="sd">        in order x, y</span>
<span class="sd">    vals : numpy.array</span>
<span class="sd">        Array of values where nodata values meet data values</span>
<span class="sd">        in order z</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;concatGrid&#39;</span><span
            class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;tpts&#39;</span><span class="p">,</span> <span
            class="n">_dt</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
    <span class="n">tpts</span> <span class="o">=</span> <span class="n">tupleGrid</span><span class="p">(</span><span
            class="n">grids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span
            class="n">maxVal</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;bpts&#39;</span><span class="p">,</span> <span
            class="n">_dt</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
    <span class="n">bpts</span> <span class="o">=</span> <span class="n">tupleGrid</span><span class="p">(</span><span
            class="n">grids</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span
            class="n">maxVal</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">,</span> <span
            class="n">_dt</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;combo1&#39;</span><span
            class="p">,</span> <span class="n">_dt</span><span class="o">.</span><span class="n">now</span><span
            class="p">())</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tpts</span><span
            class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span
            class="nb">len</span><span class="p">(</span><span class="n">bpts</span><span class="p">)</span> <span
            class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">comb</span> <span class="o">=</span> <span class="n">bpts</span>
        <span class="n">comb</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span
            class="s1">&#39;i8,i8,i8&#39;</span><span class="p">)</span><span class="o">.</span><span
            class="n">sort</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span
            class="p">[</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span
            class="s1">&#39;f1&#39;</span><span class="p">],</span> <span class="n">axis</span><span
            class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">comb</span><span class="p">)</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">hsplit</span><span class="p">(</span><span class="n">comb</span><span class="p">,</span> <span
            class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span
            class="p">])</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span
            class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span
            class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">bpts</span><span
            class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span
            class="nb">len</span><span class="p">(</span><span class="n">tpts</span><span class="p">)</span> <span
            class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">comb</span> <span class="o">=</span> <span class="n">tpts</span>
        <span class="n">comb</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span
            class="s1">&#39;i8,i8,i8&#39;</span><span class="p">)</span><span class="o">.</span><span
            class="n">sort</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span
            class="p">[</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span
            class="s1">&#39;f1&#39;</span><span class="p">],</span> <span class="n">axis</span><span
            class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">comb</span><span class="p">)</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">hsplit</span><span class="p">(</span><span class="n">comb</span><span class="p">,</span> <span
            class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span
            class="p">])</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span
            class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span
            class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tpts</span><span
            class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span
            class="nb">len</span><span class="p">(</span><span class="n">bpts</span><span class="p">)</span> <span
            class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">grid</span><span class="p">,</span> <span class="n">vals</span> <span class="o">=</span> <span
            class="p">[],</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">comb</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">concatenate</span><span class="p">([</span><span class="n">tpts</span><span
            class="p">,</span> <span class="n">bpts</span><span class="p">])</span>
        <span class="n">comb</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span
            class="s1">&#39;i8,i8,i8&#39;</span><span class="p">)</span><span class="o">.</span><span
            class="n">sort</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span
            class="p">[</span><span class="s1">&#39;f0&#39;</span><span class="p">,</span> <span
            class="s1">&#39;f1&#39;</span><span class="p">],</span> <span class="n">axis</span><span
            class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">comb</span><span class="p">)</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">hsplit</span><span class="p">(</span><span class="n">comb</span><span class="p">,</span> <span
            class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span
            class="p">])</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span
            class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span
            class="p">()</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span
            class="n">vals</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">grid</span><span class="p">,</span> <span class="n">vals</span></div>

<div class="viewcode-block" id="alignTifs"><a class="viewcode-back" href="../index.html#autointerp.alignTifs">[docs]</a><span
        class="k">def</span> <span class="nf">alignTifs</span><span class="p">(</span><span class="n">tifs</span><span
        class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes an input of an array of tiff objects. The goal of this function</span>
<span class="sd">    is to fit the provided tifs to the largest combined area of the inputs.</span>


<span class="sd">    1. Find NW and SE corners of the first input array and the number of rows and columns in the input.</span>
<span class="sd">    2. Find NW and SE corners of subsiquent input arrays and record differences as the NW differences (nxd, nyd) SE differences (sxd, syd).</span>

<span class="sd">        - also modify the original NW and/or SE corner values if applicable.</span>
<span class="sd">        - also modify the original number or rows and columns if applicable.</span>

<span class="sd">    3. Resize the area of each input array to the new total combined size of all input arrays based on the stored number of rows and columns.</span>
<span class="sd">    4. Reposition the data within each input array to maintain original geographic placement based on the difference of the input array&#39;s original NW corner and the recorded &#39;largest&#39; NW boundry of the combined input areas.</span>
<span class="sd">    5. Return tiff objects with the newly resized/repositioned tifs and the new NW and SE extents of the new combined area.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tifs : list</span>
<span class="sd">        List of GeoTiff objects created by :func:`getTifElev`</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sizedTifs : list</span>
<span class="sd">        GeoTiff file objects with numpy.array raster data replaced with data</span>
<span class="sd">        that is alligned within the maximum extents of all input GeoTiffs</span>
<span class="sd">    tifs : list</span>
<span class="sd">        Replaces sizedTifs if there is no resizing needed</span>
<span class="sd">    ext : list</span>
<span class="sd">        The maximum extents of all input GeoTiffs</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;alignTifs&#39;</span><span
            class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1">#    maxVal = 0</span>
    <span class="n">nw</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span
            class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span
            class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">sxd</span><span class="p">,</span> <span class="n">nyd</span> <span class="o">=</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">nxd</span><span class="p">,</span> <span class="n">syd</span> <span class="o">=</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">tif</span> <span class="ow">in</span> <span class="n">tifs</span><span
            class="p">:</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">tif</span><span class="p">[</span><span
            class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ul</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span>
        <span class="n">lr</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span
            class="p">:</span>
            <span class="n">nw</span> <span class="o">=</span> <span class="n">ul</span>
            <span class="n">se</span> <span class="o">=</span> <span class="n">lr</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">nw</span><span
            class="p">,</span> <span class="n">se</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ulx</span><span class="p">,</span> <span class="n">uly</span> <span class="o">=</span> <span
            class="n">ul</span>
            <span class="n">lrx</span><span class="p">,</span> <span class="n">lry</span> <span class="o">=</span> <span
            class="n">lr</span>
            <span class="n">nwx</span><span class="p">,</span> <span class="n">nwy</span> <span class="o">=</span> <span
            class="n">nw</span>
            <span class="n">scx</span><span class="p">,</span> <span class="n">scy</span> <span class="o">=</span> <span
            class="n">se</span>
            <span class="k">if</span> <span class="n">ulx</span> <span class="o">&lt;=</span> <span class="n">nwx</span><span
            class="p">:</span>
                <span class="n">nxd</span> <span class="o">=</span> <span class="n">nwx</span> <span class="o">-</span> <span
            class="n">ulx</span>
                <span class="n">nwx</span> <span class="o">=</span> <span class="n">ulx</span>
            <span class="k">elif</span> <span class="n">ulx</span> <span class="o">&gt;=</span> <span
            class="n">nwx</span><span class="p">:</span>
                <span class="n">nxd</span> <span class="o">=</span> <span class="n">ulx</span> <span class="o">-</span> <span
            class="n">nwx</span>
<span class="c1">#                nwx = nwx</span>
            <span class="k">if</span> <span class="n">uly</span> <span class="o">&gt;=</span> <span class="n">nwy</span><span
            class="p">:</span>
                <span class="n">nyd</span> <span class="o">=</span> <span class="n">uly</span> <span class="o">-</span> <span
            class="n">nwy</span>
                <span class="n">nwy</span> <span class="o">=</span> <span class="n">uly</span>
            <span class="k">elif</span> <span class="n">uly</span> <span class="o">&lt;=</span> <span
            class="n">nwy</span><span class="p">:</span>
                <span class="n">nyd</span> <span class="o">=</span> <span class="n">nwy</span> <span class="o">-</span> <span
            class="n">uly</span>
<span class="c1">#                nwy = nwy</span>
            <span class="k">if</span> <span class="n">lrx</span> <span class="o">&gt;=</span> <span class="n">scx</span><span
            class="p">:</span>
                <span class="n">sxd</span> <span class="o">=</span> <span class="n">lrx</span> <span class="o">-</span> <span
            class="n">scx</span>
                <span class="n">scx</span> <span class="o">=</span> <span class="n">lrx</span>
            <span class="k">elif</span> <span class="n">lrx</span> <span class="o">&lt;=</span> <span
            class="n">scx</span><span class="p">:</span>
                <span class="n">sxd</span> <span class="o">=</span> <span class="n">scx</span> <span class="o">-</span> <span
            class="n">lrx</span>
<span class="c1">#                scx = scx</span>
            <span class="k">if</span> <span class="n">lry</span> <span class="o">&lt;=</span> <span class="n">scy</span><span
            class="p">:</span>
                <span class="n">syd</span> <span class="o">=</span> <span class="n">lry</span> <span class="o">-</span> <span
            class="n">scy</span>
                <span class="n">scy</span> <span class="o">=</span> <span class="n">lry</span>
            <span class="k">elif</span> <span class="n">lry</span> <span class="o">&gt;=</span> <span
            class="n">scy</span><span class="p">:</span>
                <span class="n">syd</span> <span class="o">=</span> <span class="n">scy</span> <span class="o">-</span> <span
            class="n">lry</span>
<span class="c1">#                scy = scy</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">nxd</span><span
            class="p">,</span> <span class="n">nyd</span><span class="p">,</span> <span class="n">sxd</span><span
            class="p">,</span> <span class="n">syd</span><span class="p">)</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">sxd</span><span
            class="p">,</span> <span class="n">nyd</span><span class="p">)</span>
            <span class="n">nw</span> <span class="o">=</span> <span class="p">[</span><span class="n">nwx</span><span
            class="p">,</span> <span class="n">nwy</span><span class="p">]</span>
            <span class="n">se</span> <span class="o">=</span> <span class="p">[</span><span class="n">scx</span><span
            class="p">,</span> <span class="n">scy</span><span class="p">]</span>
            <span class="n">cols</span><span class="p">,</span> <span class="n">rows</span> <span
            class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_np</span><span
            class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">nwy</span> <span
            class="o">-</span> <span class="n">scy</span><span class="p">)),</span> <span class="nb">int</span><span
            class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">round</span><span
            class="p">(</span><span class="n">scx</span> <span class="o">-</span> <span class="n">nwx</span><span
            class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cols: &#39;</span> <span
            class="p">,</span> <span class="n">nwy</span> <span class="o">-</span> <span class="n">scy</span><span
            class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span
            class="s1">rows: &#39;</span><span class="p">,</span> <span class="n">scx</span> <span
            class="o">-</span> <span class="n">nwx</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">nw</span><span class="p">,</span> <span
            class="n">se</span><span class="p">)</span>
    <span class="n">sizedTifs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;resize?&#39;</span><span
            class="p">)</span>
    <span class="k">if</span> <span class="n">nxd</span> <span class="o">!=</span> <span class="mi">0</span> <span
            class="ow">or</span> <span class="n">nyd</span> <span class="o">!=</span> <span class="mi">0</span> <span
            class="ow">or</span> <span class="n">sxd</span> <span class="o">!=</span> <span class="mi">0</span> <span
            class="ow">or</span> <span class="n">syd</span> <span class="o">!=</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;yes&#39;</span><span
            class="p">,</span> <span class="n">_dt</span><span class="o">.</span><span class="n">now</span><span
            class="p">())</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">full</span><span class="p">((</span><span class="n">cols</span><span class="p">,</span> <span
            class="n">rows</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">ref</span><span class="o">.</span><span
            class="n">shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tif</span> <span class="ow">in</span> <span
            class="n">tifs</span><span class="p">:</span>
            <span class="n">maxVal</span> <span class="o">=</span> <span class="n">maxValue</span><span
            class="p">(</span><span class="n">tif</span><span class="p">[</span><span class="o">-</span><span
            class="mi">1</span><span class="p">])</span>
            <span class="n">sizedTif</span> <span class="o">=</span> <span class="n">tif</span><span class="p">[:</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">tif</span><span class="p">)</span>
            <span class="n">bndx</span><span class="p">,</span> <span class="n">bndy</span> <span
            class="o">=</span> <span class="n">tif</span><span class="p">[</span><span class="mi">2</span><span
            class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">nwx</span><span class="p">,</span> <span class="n">nwy</span> <span class="o">=</span> <span
            class="n">nw</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;old:&#39;</span><span class="p">,</span> <span
            class="n">bndx</span><span class="p">,</span> <span class="n">bndy</span><span class="p">)</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;new&#39;</span><span
            class="p">,</span> <span class="n">nwx</span><span class="p">,</span> <span class="n">nwy</span><span
            class="p">)</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">tif</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">bef</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span
            class="n">shape</span>
            <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span
            class="n">arr</span><span class="o">.</span><span class="n">shape</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span
            class="n">rows</span><span class="p">)</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span
            class="n">cols</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span
            class="n">cols</span><span class="p">:</span>
                <span class="n">exp</span> <span class="o">=</span> <span class="nb">int</span><span
            class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">rows</span> <span
            class="o">-</span> <span class="n">x</span><span class="p">))</span>
                <span class="nb">print</span> <span class="p">(</span><span class="n">exp</span><span class="p">)</span>
                <span class="n">add</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">y</span><span
            class="p">,</span> <span class="n">exp</span><span class="p">),</span> <span class="n">maxVal</span><span
            class="p">)</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span
            class="n">arr</span><span class="p">,</span> <span class="n">add</span><span class="p">])</span>
                <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span
            class="n">arr</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">if</span> <span class="n">y</span> <span class="o">!=</span> <span
            class="n">rows</span><span class="p">:</span>
                <span class="n">exp</span> <span class="o">=</span> <span class="nb">int</span><span
            class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">cols</span> <span
            class="o">-</span> <span class="n">y</span><span class="p">))</span>
                <span class="nb">print</span> <span class="p">(</span><span class="n">exp</span><span class="p">)</span>
                <span class="n">add</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">exp</span><span
            class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">maxVal</span><span
            class="p">)</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">arr</span><span
            class="p">,</span> <span class="n">add</span><span class="p">])</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">bef</span><span
            class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span
            class="p">)</span>
            <span class="k">if</span> <span class="n">nwx</span> <span class="o">!=</span> <span
            class="n">bndx</span><span class="p">:</span>
                <span class="n">rollx</span> <span class="o">=</span> <span class="n">bndx</span> <span
            class="o">-</span> <span class="n">nwx</span>
                <span class="nb">print</span> <span class="p">(</span><span class="n">rollx</span><span
            class="p">)</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">arr</span><span
            class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">rollx</span><span
            class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span
            class="p">)</span>
            <span class="k">if</span> <span class="n">nwy</span> <span class="o">!=</span> <span
            class="n">bndy</span><span class="p">:</span>
                <span class="n">rolly</span> <span class="o">=</span> <span class="n">nwy</span> <span
            class="o">-</span> <span class="n">bndy</span>
                <span class="nb">print</span> <span class="p">(</span><span class="n">rolly</span><span
            class="p">)</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">arr</span><span
            class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">rolly</span><span
            class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span
            class="p">)</span>
            <span class="n">sizedTif</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
            class="n">arr</span><span class="p">)</span>
            <span class="n">sizedTifs</span><span class="o">.</span><span class="n">append</span><span
            class="p">(</span><span class="n">sizedTif</span><span class="p">)</span>
<span class="c1">#            sizedTifs.append(arr)</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="p">[</span><span class="n">nw</span><span
            class="p">,</span> <span class="n">se</span><span class="p">]</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">ext</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;done&#39;</span><span
            class="p">,</span> <span class="n">_dt</span><span class="o">.</span><span class="n">now</span><span
            class="p">())</span>
        <span class="k">return</span> <span class="n">sizedTifs</span><span class="p">,</span> <span
            class="n">ext</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;same&#39;</span><span
            class="p">)</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="p">[</span><span class="n">nw</span><span
            class="p">,</span> <span class="n">se</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">tifs</span><span class="p">,</span> <span
            class="n">ext</span></div>

<div class="viewcode-block" id="polyTifVals"><a class="viewcode-back"
                                                href="../index.html#autointerp.polyTifVals">[docs]</a><span class="k">def</span> <span
        class="nf">polyTifVals</span><span class="p">(</span><span class="n">tifs</span><span class="p">,</span> <span
        class="n">path</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span
        class="n">extent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Heavy Influence From:</span>
<span class="sd">    &quot;What is the simplest way...&quot; on GIS Stack Exchange [Answer by &#39;Jon&#39;</span>
<span class="sd">    (https://gis.stackexchange.com/a/278965)]</span>

<span class="sd">    This function takes an array input of tif objects, a destination path (for</span>
<span class="sd">    ouput saving), and a list the names of the input tif objects.</span>

<span class="sd">    Takes the arrays of each tif object and combines them along the z axis of</span>
<span class="sd">    each::</span>

<span class="sd">        [[za,zb],[za,zb],[za,zb],</span>
<span class="sd">         [za,zb],[za,zb],[za,zb],</span>
<span class="sd">         [za,zb],[za,zb],[za,zb]]</span>

<span class="sd">    Then takes the mean of the values along the z axis. The reslult is then</span>
<span class="sd">    modified to a binary raster by making all values that are not the nodata</span>
<span class="sd">    value 1 and the values that are nodata 0.</span>

<span class="sd">    This binary raster is saved at the input path and also returned with the</span>
<span class="sd">    new full path for the output</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tifs : list</span>
<span class="sd">        List of GeoTiff objects</span>
<span class="sd">    path : string</span>
<span class="sd">        Folder path for the output files</span>
<span class="sd">    names : list</span>
<span class="sd">        List of names of imported GeoTiffs</span>
<span class="sd">    extent : list</span>
<span class="sd">        The maximum extents of all input GeoTiffs</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    meanTiff : numpy.array</span>
<span class="sd">        Binary raster only showing data and nodata areas for all of the input</span>
<span class="sd">        GeoTiff data</span>
<span class="sd">    outputtiff : string</span>
<span class="sd">        File name and path generated for saving meanTiff data in Tiff format</span>
<span class="sd">    outputhdf5 : string</span>
<span class="sd">        File name and path generated for saving meanTiff data in HDF5 format</span>
<span class="sd">    targs : list</span>
<span class="sd">        Additional arguments passed back for use in :func:`alignGrids`</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;polyTifVals&#39;</span><span
            class="p">)</span>
    <span class="n">letters</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">_al</span><span
            class="p">:</span>
        <span class="n">letters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
            class="n">letter</span><span class="p">)</span>
    <span class="n">maxRes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span
            class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">maxVal</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">tifList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">tif</span> <span class="ow">in</span> <span class="n">tifs</span><span
            class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">tif</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span
            class="p">)</span>
        <span class="n">maxVal</span> <span class="o">=</span> <span class="n">maxValue</span><span
            class="p">(</span><span class="n">tif</span><span class="p">[</span><span class="o">-</span><span
            class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">maxVal</span><span class="p">)</span>
        <span class="p">[</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">tif</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span
            class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;original&#39;</span><span
            class="p">,</span> <span class="n">maxRes</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;=</span> <span
            class="n">maxRes</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">maxRes</span><span class="p">[</span><span class="mi">0</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">rows</span>
            <span class="k">if</span> <span class="n">cols</span> <span class="o">&gt;=</span> <span
            class="n">maxRes</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">maxRes</span><span class="p">[</span><span class="mi">1</span><span
            class="p">]</span> <span class="o">=</span> <span class="n">cols</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;original&#39;</span><span
            class="p">,</span> <span class="n">maxRes</span><span class="p">)</span>
            <span class="n">tifList</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span
            class="n">tif</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span
            class="n">tif</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]])</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">!=</span> <span class="mi">0</span><span
            class="p">:</span>
            <span class="k">if</span> <span class="p">[</span><span class="n">tif</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span
            class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tif</span><span
            class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span
            class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span
            class="p">]]</span> <span class="o">!=</span> <span class="n">maxRes</span><span class="p">:</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;nope&#39;</span><span
            class="p">)</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tifList</span><span class="o">.</span><span class="n">append</span><span
            class="p">([</span><span class="n">tif</span><span class="p">[</span><span class="mi">0</span><span
            class="p">],</span> <span class="n">tif</span><span class="p">[</span><span class="o">-</span><span
            class="mi">1</span><span class="p">]])</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;yup&#39;</span><span
            class="p">)</span>
        <span class="n">tifDict</span> <span class="o">=</span> <span class="nb">dict</span><span
            class="p">(</span><span class="n">tifList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tif</span> <span
            class="ow">in</span> <span class="n">tifDict</span><span class="o">.</span><span class="n">items</span><span
            class="p">():</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">tif</span><span
            class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span
            class="p">:</span>
                <span class="n">allarrays</span> <span class="o">=</span> <span class="n">array</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">allarrays</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span
            class="n">allarrays</span><span class="p">,</span> <span class="n">array</span><span
            class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span
            class="p">)</span>

        <span class="n">meanTiff</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">nanmean</span><span class="p">(</span><span class="n">allarrays</span><span
            class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span
            class="p">)</span>
        <span class="k">if</span> <span class="n">maxVal</span> <span class="o">!=</span> <span class="mi">0</span><span
            class="p">:</span>
            <span class="n">meanTiff</span> <span class="o">=</span> <span class="p">(</span><span
            class="n">meanTiff</span> <span class="o">&lt;</span> <span class="n">maxVal</span><span
            class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span
            class="n">_np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">meanTiff</span> <span class="o">=</span> <span class="p">(</span><span
            class="n">meanTiff</span> <span class="o">&gt;</span> <span class="n">maxVal</span><span
            class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span
            class="n">_np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>

    <span class="n">outputname</span> <span class="o">=</span> <span class="n">path</span> <span
            class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span
            class="s1">&#39;</span> <span class="o">+</span> <span class="n">names</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_COMBINEDPOLY&#39;</span>
    <span class="n">outputtiff</span> <span class="o">=</span> <span class="n">outputname</span> <span
            class="o">+</span> <span class="s1">&#39;.tif&#39;</span>
    <span class="n">outputhdf5</span> <span class="o">=</span> <span class="n">outputname</span> <span
            class="o">+</span> <span class="s1">&#39;.h5&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">outputname</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">_os</span><span class="o">.</span><span class="n">path</span><span
            class="o">.</span><span class="n">exists</span><span class="p">(</span><span
            class="n">outputtiff</span><span class="p">):</span>
            <span class="n">_os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span
            class="n">outputtiff</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">_os</span><span class="o">.</span><span
            class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span
            class="n">outputtiff</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">_os</span><span class="o">.</span><span class="n">path</span><span
            class="o">.</span><span class="n">exists</span><span class="p">(</span><span
            class="n">outputhdf5</span><span class="p">):</span>
            <span class="n">_os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span
            class="n">outputhdf5</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">_os</span><span class="o">.</span><span
            class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span
            class="n">outputhdf5</span><span class="p">):</span>
            <span class="k">break</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">nx</span> <span class="o">=</span> <span
            class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">reso</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">gtran</span> <span class="o">=</span> <span class="p">(</span><span class="n">ny</span><span
            class="p">,</span> <span class="n">reso</span><span class="p">,</span> <span class="mf">0.0</span><span
            class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mf">0.0</span><span
            class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">reso</span><span
            class="p">))</span>
<span class="c1">#    write_raster(meanTiff, gtran, gd_obj, outputtiff, options = [&#39;COMPRESS=LZW&#39;])</span>
<span class="c1">#    gd_obj = None</span>

    <span class="n">targs</span> <span class="o">=</span> <span class="p">[</span><span class="n">gtran</span><span
            class="p">,</span> <span class="n">tifs</span><span class="p">[</span><span class="o">-</span><span
            class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span
            class="n">outputtiff</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;done?&#39;</span><span
            class="p">)</span>
    <span class="k">return</span> <span class="n">meanTiff</span><span class="p">,</span> <span
            class="n">outputtiff</span><span class="p">,</span>  <span class="n">outputhdf5</span><span
            class="p">,</span> <span class="n">targs</span></div>

<div class="viewcode-block" id="shift5"><a class="viewcode-back" href="../index.html#autointerp.shift5">[docs]</a><span
        class="k">def</span> <span class="nf">shift5</span><span class="p">(</span><span class="n">arr</span><span
        class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span
        class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">_np</span><span
        class="o">.</span><span class="n">nan</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;https://stackoverflow.com/questions/30399534/shift-elements-in-a-numpy-array&quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;shift5&#39;</span><span
            class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">empty_like</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="n">result</span><span class="p">[:</span><span class="n">y</span><span class="p">,:]</span> <span
            class="o">=</span> <span class="n">fill_value</span>
        <span class="n">result</span><span class="p">[</span><span class="n">y</span><span class="p">:,:]</span> <span
            class="o">=</span> <span class="n">arr</span><span class="p">[:</span><span class="o">-</span><span
            class="n">y</span><span class="p">,:]</span>
    <span class="k">elif</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="n">result</span><span class="p">[</span><span class="n">y</span><span class="p">:,:]</span> <span
            class="o">=</span> <span class="n">fill_value</span>
        <span class="n">result</span><span class="p">[:</span><span class="n">y</span><span class="p">,:]</span> <span
            class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="o">-</span><span
            class="n">y</span><span class="p">:,:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">arr</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;shift6&#39;</span><span
            class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="n">result</span><span class="p">[:,:</span><span class="n">x</span><span class="p">]</span> <span
            class="o">=</span> <span class="n">fill_value</span>
        <span class="n">result</span><span class="p">[:,</span><span class="n">x</span><span class="p">:]</span> <span
            class="o">=</span> <span class="n">arr</span><span class="p">[:,:</span><span class="o">-</span><span
            class="n">x</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="n">result</span><span class="p">[:,</span><span class="n">x</span><span class="p">:]</span> <span
            class="o">=</span> <span class="n">fill_value</span>
        <span class="n">result</span><span class="p">[:,:</span><span class="n">x</span><span class="p">]</span> <span
            class="o">=</span> <span class="n">arr</span><span class="p">[:,</span><span class="o">-</span><span
            class="n">x</span><span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">arr</span>
    <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="alignGrids"><a class="viewcode-back"
                                               href="../index.html#autointerp.alignGrids">[docs]</a><span
        class="k">def</span> <span class="nf">alignGrids</span><span class="p">(</span><span class="n">bag</span><span
        class="p">,</span> <span class="n">tif</span><span class="p">,</span> <span class="n">maxVal</span><span
        class="p">,</span> <span class="n">targs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes an input of two arrays representing bag and tif data. These arrays</span>
<span class="sd">    hold information like extent, data, and more. The goal of this function is</span>
<span class="sd">    to fit and/or shift the provided tif to the area of the bag.</span>

<span class="sd">    Steps:</span>

<span class="sd">    1. Determine/confirm the resolution of the tif using a mix of file naming, extent, and dimensions.</span>
<span class="sd">    2. Determine the resolution of the bag using file naming conventions.</span>
<span class="sd">    3. Calculate the tif/bag resolution to determine the value needed to resize the tif.</span>
<span class="sd">    4. Resize the tif so that the resolution matches the bag using.</span>
<span class="sd">    5. Convert tif values to either numpy.nan or maxVal for use later.</span>
<span class="sd">    6. Store the extents of the bag and tif and calculate the difference.</span>
<span class="sd">    7. Create an empty array with dimensions equal to the original extents of the tiff data plus the additional space needed to match the total extents of the BAG data.</span>
<span class="sd">    8. Align the content of the tiff as needed in order to match the bag and apply the shifted content to the empty array created in Step 7.</span>
<span class="sd">    9. Enforce the size of the bag onto the shifted tiff data stored in the array created and modified in Step(s) 7 and 8.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bag : list</span>
<span class="sd">        BAG file object</span>
<span class="sd">        Position loaded, file name, grid extents, file size, grid dimensions,</span>
<span class="sd">        uncertainty numpy.array, bathymetry numpy.array</span>
<span class="sd">    tif : list</span>
<span class="sd">        GeoTiff file objects with numpy.array raster data replaced with binary</span>
<span class="sd">        data only showing data and nodata areas and that is alligned within</span>
<span class="sd">        the maximum extents of all input GeoTiffs</span>
<span class="sd">    maxVal : int</span>
<span class="sd">        Maximum occurance value AKA nodata value</span>
<span class="sd">    targs : list</span>
<span class="sd">        Additional arguments generated in :func:`polyTifVals` for use in saving</span>
<span class="sd">        the BAG aligned Tiff data</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bagRes : float</span>
<span class="sd">        Resolution of the BAG data</span>
<span class="sd">    grids : list</span>
<span class="sd">        The BAG and GeoTiff objects, GeoTiff object&#39;s numpy.array raster data</span>
<span class="sd">        replaced with BAG aligned Tiff data</span>
<span class="sd">    bagBounds : list</span>
<span class="sd">        Geographic extent of the BAG data</span>
<span class="sd">    bShape : tuple</span>
<span class="sd">        Dimensions of the input BAG data (y, x)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;alignGrids&#39;</span><span
            class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">bag</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1">##1</span>
    <span class="n">tu</span><span class="p">,</span> <span class="n">tl</span> <span class="o">=</span> <span
            class="n">tif</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span
            class="p">]</span>
    <span class="n">ty</span><span class="p">,</span> <span class="n">tx</span> <span class="o">=</span> <span
            class="n">tif</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">tex</span><span class="p">,</span> <span class="n">tey</span> <span class="o">=</span> <span
            class="nb">int</span><span class="p">(</span><span class="n">tl</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">tu</span><span
            class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span
            class="p">(</span><span class="n">tu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span
            class="o">-</span> <span class="n">tl</span><span class="p">[</span><span class="mi">1</span><span
            class="p">])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span
            class="n">ty</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">tex</span><span class="p">,</span> <span
            class="n">tey</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tex</span><span class="o">-</span><span class="n">ty</span> <span
            class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">tey</span><span
            class="o">-</span><span class="n">tx</span> <span class="o">==</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="n">tifRes</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;same tif res&#39;</span><span
            class="p">,</span><span class="n">tifRes</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tifRes</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">round</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span
            class="n">mean</span><span class="p">([</span><span class="n">tex</span><span class="o">/</span><span
            class="n">tx</span><span class="p">,</span> <span class="n">tey</span><span class="o">/</span><span
            class="n">ty</span><span class="p">]))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;diff tif res&#39;</span><span
            class="p">,</span><span class="n">tifRes</span><span class="p">)</span>

    <span class="c1">##2</span>
    <span class="n">splits</span> <span class="o">=</span> <span class="n">_os</span><span class="o">.</span><span
            class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span
            class="n">bag</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">splits</span><span class="p">)</span>
    <span class="n">splits</span> <span class="o">=</span> <span class="n">splits</span><span class="o">.</span><span
            class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span
            class="p">)[</span><span class="mi">2</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">splits</span><span class="p">)</span>
    <span class="n">bagRes</span> <span class="o">=</span> <span class="n">_re</span><span class="o">.</span><span
            class="n">split</span><span class="p">(</span><span class="s1">&#39;(\d+)&#39;</span><span
            class="p">,</span><span class="n">splits</span><span class="p">)[</span><span class="o">-</span><span
            class="mi">2</span><span class="p">:]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">bagRes</span><span class="p">)</span>

    <span class="c1">## 3</span>
    <span class="k">if</span> <span class="n">bagRes</span><span class="p">[</span><span class="o">-</span><span
            class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span
            class="s1">&#39;cm&#39;</span><span class="p">:</span>
        <span class="n">bagRes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
            class="n">bagRes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span
            class="o">/</span> <span class="mi">100</span>
        <span class="n">zres</span> <span class="o">=</span> <span class="n">tifRes</span><span class="o">/</span><span
            class="n">bagRes</span>
    <span class="k">elif</span> <span class="n">bagRes</span><span class="p">[</span><span class="o">-</span><span
            class="mi">1</span><span class="p">]</span> <span class="o">==</span><span
            class="s1">&#39;m&#39;</span><span class="p">:</span>
        <span class="n">bagRes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
            class="n">bagRes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">zres</span> <span class="o">=</span> <span class="n">tifRes</span><span class="o">/</span><span
            class="n">bagRes</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">bagRes</span><span class="p">,</span> <span
            class="n">zres</span><span class="p">)</span>
    <span class="n">_plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span
            class="n">tif</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span
            class="p">][::</span><span class="mi">100</span><span class="p">,::</span><span class="mi">100</span><span
            class="p">])</span>
    <span class="n">_plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="c1">## 4</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">tif</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">zres</span> <span class="o">==</span> <span class="mi">1</span><span
            class="p">:</span>
        <span class="n">newarr</span> <span class="o">=</span> <span class="n">tif</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;_zoom&#39;</span><span
            class="p">,</span> <span class="n">_dt</span><span class="o">.</span><span class="n">now</span><span
            class="p">())</span>
        <span class="n">newarr</span> <span class="o">=</span> <span class="n">_zoom</span><span class="p">(</span><span
            class="n">tif</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span
            class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="p">[</span><span
            class="n">zres</span><span class="p">,</span> <span class="n">zres</span><span class="p">],</span> <span
            class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span
            class="n">prefilter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;zoomed&#39;</span><span
            class="p">,</span> <span class="n">_dt</span><span class="o">.</span><span class="n">now</span><span
            class="p">())</span>
    <span class="n">_plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span
            class="n">newarr</span><span class="p">[::</span><span class="mi">100</span><span class="p">,::</span><span
            class="mi">100</span><span class="p">])</span>
    <span class="n">_plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1">## 5</span>
    <span class="n">newarr</span> <span class="o">=</span> <span class="n">newarr</span><span class="o">.</span><span
            class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span
            class="p">)</span>
    <span class="n">newarr</span><span class="p">[</span><span class="n">newarr</span> <span class="o">&gt;</span> <span
            class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">nan</span>
    <span class="n">newarr</span><span class="p">[</span><span class="n">newarr</span> <span class="o">&lt;</span> <span
            class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span
            class="p">(</span><span class="n">maxVal</span><span class="p">)</span>
    <span class="n">_plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span
            class="n">newarr</span><span class="p">[::</span><span class="mi">100</span><span class="p">,::</span><span
            class="mi">100</span><span class="p">])</span>
    <span class="n">_plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">newarr</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">tif</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span
            class="p">,</span> <span class="n">newarr</span><span class="o">.</span><span class="n">shape</span><span
            class="p">)</span>

    <span class="c1">## 6</span>
    <span class="n">bagBounds</span> <span class="o">=</span> <span class="n">bag</span><span class="p">[</span><span
            class="mi">2</span><span class="p">]</span>
    <span class="n">tifBounds</span> <span class="o">=</span> <span class="n">tif</span><span class="p">[</span><span
            class="mi">2</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">bagBounds</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">tifBounds</span><span class="p">)</span>
    <span class="n">bulx</span><span class="p">,</span> <span class="n">buly</span> <span class="o">=</span> <span
            class="n">bagBounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">blrx</span><span class="p">,</span> <span class="n">blry</span> <span class="o">=</span> <span
            class="n">bagBounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]</span>
    <span class="n">tulx</span><span class="p">,</span> <span class="n">tuly</span> <span class="o">=</span> <span
            class="n">tifBounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">tlrx</span><span class="p">,</span> <span class="n">tlry</span> <span class="o">=</span> <span
            class="n">tifBounds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]</span>
    <span class="n">dulx</span><span class="p">,</span> <span class="n">duly</span><span class="p">,</span> <span
            class="n">dlrx</span><span class="p">,</span> <span class="n">dlry</span> <span class="o">=</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">bulx</span> <span class="o">!=</span> <span class="n">tulx</span><span
            class="p">:</span>
        <span class="n">dulx</span> <span class="o">=</span> <span class="n">tulx</span> <span class="o">-</span> <span
            class="n">bulx</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">bulx</span><span class="p">,</span> <span
            class="n">tulx</span><span class="p">,</span> <span class="n">dulx</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">buly</span> <span class="o">!=</span> <span class="n">tuly</span><span
            class="p">:</span>
        <span class="n">duly</span> <span class="o">=</span> <span class="n">buly</span> <span class="o">-</span> <span
            class="n">tuly</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">buly</span><span class="p">,</span> <span
            class="n">tuly</span><span class="p">,</span> <span class="n">duly</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">blrx</span> <span class="o">!=</span> <span class="n">tlrx</span><span
            class="p">:</span>
        <span class="n">dlrx</span> <span class="o">=</span> <span class="n">blrx</span> <span class="o">-</span> <span
            class="n">tlrx</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">blrx</span><span class="p">,</span> <span
            class="n">tlrx</span><span class="p">,</span> <span class="n">dlrx</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">blry</span> <span class="o">!=</span> <span class="n">tlry</span><span
            class="p">:</span>
        <span class="n">dlry</span> <span class="o">=</span> <span class="n">tlry</span> <span class="o">-</span> <span
            class="n">blry</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">blry</span><span class="p">,</span> <span
            class="n">tlry</span><span class="p">,</span> <span class="n">dlry</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">dulx</span><span class="p">,</span> <span
            class="n">duly</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">dlrx</span><span class="p">,</span> <span
            class="n">dlry</span><span class="p">)</span>

    <span class="c1">## 7</span>
    <span class="n">bShape</span> <span class="o">=</span> <span class="n">bag</span><span class="p">[</span><span
            class="mi">4</span><span class="p">]</span>
    <span class="n">bSy</span><span class="p">,</span> <span class="n">bSx</span> <span class="o">=</span> <span
            class="n">bShape</span>
    <span class="n">tSy</span><span class="p">,</span> <span class="n">tSx</span> <span class="o">=</span> <span
            class="n">newarr</span><span class="o">.</span><span class="n">shape</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">bSy</span><span class="p">,</span> <span
            class="n">tSy</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">bSx</span><span class="p">,</span> <span
            class="n">tSx</span><span class="p">)</span>
    <span class="n">expx</span><span class="p">,</span> <span class="n">expy</span> <span class="o">=</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">newarr</span><span class="o">.</span><span class="n">shape</span> <span
            class="o">!=</span> <span class="n">bShape</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">bSy</span> <span class="o">-</span> <span
            class="n">tSy</span><span class="p">,</span> <span class="n">bSx</span> <span class="o">-</span> <span
            class="n">tSx</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tSy</span> <span class="o">&lt;</span> <span class="n">bSy</span><span
            class="p">:</span>
            <span class="n">expy</span> <span class="o">=</span> <span class="nb">int</span><span
            class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">abs</span><span
            class="p">(</span><span class="n">bSy</span> <span class="o">-</span> <span class="n">tSy</span><span
            class="p">))</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;expy&#39;</span><span class="p">,</span> <span
            class="n">expy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tSx</span> <span class="o">&lt;</span> <span class="n">bSx</span><span
            class="p">:</span>
            <span class="n">expx</span> <span class="o">=</span> <span class="nb">int</span><span
            class="p">(</span><span class="n">_np</span><span class="o">.</span><span class="n">abs</span><span
            class="p">(</span><span class="n">bSx</span> <span class="o">-</span> <span class="n">tSx</span><span
            class="p">))</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;expx&#39;</span><span class="p">,</span> <span
            class="n">expx</span><span class="p">)</span>
    <span class="n">ay</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">full</span><span class="p">((</span><span class="n">tSy</span><span class="o">+</span><span
            class="n">expy</span><span class="p">,</span><span class="n">tSx</span><span class="o">+</span><span
            class="n">expx</span><span class="p">),</span> <span class="n">maxVal</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;expz&#39;</span><span class="p">,</span> <span
            class="n">ay</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span
            class="n">bShape</span><span class="p">)</span>
    <span class="n">rollx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
            class="n">dulx</span><span class="o">*</span><span class="n">zres</span><span class="p">)</span>
    <span class="n">rolly</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
            class="n">duly</span><span class="o">*</span><span class="n">zres</span><span class="p">)</span>

    <span class="c1">## 8</span>
    <span class="n">up</span><span class="p">,</span> <span class="n">left</span> <span class="o">=</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">down</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">duly</span> <span class="o">&lt;</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="n">up</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span
            class="p">(</span><span class="n">rolly</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">duly</span> <span class="o">&gt;</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="n">down</span> <span class="o">=</span> <span class="n">rolly</span>
        <span class="n">up</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">dulx</span> <span class="o">&lt;</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="n">left</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span
            class="p">(</span><span class="n">rollx</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dulx</span> <span class="o">&gt;</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">rollx</span>
        <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">dulx</span> <span class="o">!=</span> <span class="mi">0</span> <span
            class="ow">or</span> <span class="n">duly</span> <span class="o">!=</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;rollz&#39;</span><span
            class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">left</span><span
            class="p">,</span> <span class="n">down</span><span class="p">,</span> <span class="n">right</span><span
            class="p">)</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">newarr</span><span class="p">[</span><span
            class="n">up</span><span class="p">:,</span><span class="n">left</span><span class="p">:]</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">temp</span><span class="o">.</span><span
            class="n">shape</span><span class="p">)</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span
            class="n">temp</span><span class="p">[::</span><span class="mi">100</span><span class="p">,::</span><span
            class="mi">100</span><span class="p">])</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">ay</span><span class="p">[</span><span class="n">down</span><span class="p">:</span><span
            class="n">temp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">down</span><span
            class="p">,</span><span class="n">right</span><span class="p">:</span><span class="n">temp</span><span
            class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span
            class="p">]</span><span class="o">+</span><span class="n">right</span><span class="p">]</span> <span
            class="o">=</span> <span class="n">temp</span><span class="p">[:,:]</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ay</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">newarr</span><span
            class="p">[:]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;expz&#39;</span><span class="p">,</span> <span
            class="n">ay</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">full</span><span class="p">(</span><span class="n">bShape</span><span class="p">,</span> <span
            class="n">maxVal</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">ay</span><span
            class="p">[:</span><span class="n">bSy</span><span class="p">,:</span><span class="n">bSx</span><span
            class="p">]</span>
    <span class="n">newarr</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">ay</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1">## 9</span>
    <span class="n">gd_obj</span> <span class="o">=</span> <span class="n">_gdal</span><span class="o">.</span><span
            class="n">Open</span><span class="p">(</span><span class="n">targs</span><span class="p">[</span><span
            class="mi">1</span><span class="p">])</span>
    <span class="n">tif</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">tif</span><span class="p">)</span>
    <span class="n">tif</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
            class="n">ax</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">tif</span><span class="p">,</span> <span
            class="n">tif</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#    print (&#39;h5&#39;)</span>
<span class="c1">#    outputhdf5 = tif[1]</span>
<span class="c1">#    f = _tb.open_file(outputhdf5, &#39;w&#39;)</span>
<span class="c1">#    atom = _tb.Atom.from_dtype(ax.dtype)</span>
<span class="c1">#    ds = f.create_carray(f.root, &#39;data&#39;, atom, bShape)</span>
<span class="c1">#    ds[:] = ax</span>
<span class="c1">#    f.close()</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;tiff&#39;</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">targs</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span>
    <span class="n">gt</span> <span class="o">=</span> <span class="p">(</span><span class="n">bulx</span><span
            class="p">,</span> <span class="n">bagRes</span><span class="p">,</span> <span class="n">temp</span><span
            class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">buly</span><span
            class="p">,</span> <span class="n">temp</span><span class="p">[</span><span class="mi">4</span><span
            class="p">],</span> <span class="o">-</span><span class="p">(</span><span class="n">bagRes</span><span
            class="p">))</span>
    <span class="n">write_raster</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span
            class="n">gt</span><span class="p">,</span> <span class="n">gd_obj</span><span class="p">,</span> <span
            class="n">targs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span
            class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;COMPRESS=LZW&#39;</span><span
            class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">grids</span> <span class="o">=</span> <span class="p">[</span><span class="n">tif</span><span
            class="p">,</span> <span class="n">bag</span><span class="p">]</span>
    <span class="n">bShape</span> <span class="o">=</span> <span class="n">bag</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">return</span> <span class="n">bagRes</span><span class="p">,</span> <span
            class="n">grids</span><span class="p">,</span> <span class="n">bagBounds</span><span
            class="p">,</span> <span class="n">bShape</span></div>

<div class="viewcode-block" id="comboGrid"><a class="viewcode-back" href="../index.html#autointerp.comboGrid">[docs]</a><span
        class="k">def</span> <span class="nf">comboGrid</span><span class="p">(</span><span class="n">grids</span><span
        class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prepares the tif and bag data to be split in concatGrid and returns</span>
<span class="sd">    the results</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    grids : list</span>
<span class="sd">        The BAG and GeoTiff objects</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    combo : numpy.array</span>
<span class="sd">        Array of indecies where nodata values meet data values</span>
<span class="sd">        in order x, y</span>
<span class="sd">    vals : numpy.array</span>
<span class="sd">        Array of values where nodata values meet data values</span>
<span class="sd">        in order z</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;comboGrid&#39;</span><span
            class="p">)</span>
    <span class="n">maxVal</span> <span class="o">=</span> <span class="n">maxValue</span><span class="p">(</span><span
            class="n">grids</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span
            class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">grids</span><span class="p">[</span><span
            class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">tif</span> <span class="o">=</span> <span class="n">grids</span><span class="p">[</span><span
            class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]</span>
    <span class="n">bag</span> <span class="o">=</span> <span class="n">grids</span><span class="p">[</span><span
            class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]</span>
    <span class="n">arrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">tif</span><span
            class="p">,</span> <span class="n">bag</span><span class="p">]</span>
    <span class="n">combo</span><span class="p">,</span> <span class="n">vals</span> <span class="o">=</span> <span
            class="n">concatGrid</span><span class="p">(</span><span class="n">arrs</span><span class="p">,</span> <span
            class="n">maxVal</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">combo</span><span class="p">,</span> <span class="n">vals</span></div>

<div class="viewcode-block" id="rePrint"><a class="viewcode-back"
                                            href="../index.html#autointerp.rePrint">[docs]</a><span class="k">def</span> <span
        class="nf">rePrint</span><span class="p">(</span><span class="n">grids</span><span class="p">,</span> <span
        class="n">ugrids</span><span class="p">,</span> <span class="n">maxVal</span><span class="p">,</span> <span
        class="n">ioVal</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span
        class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Uses a mix of interpolated and original bag and tif data in order to</span>
<span class="sd">    determine where new interpolated data should be applied. No interpolated</span>
<span class="sd">    data is used where original bag data exists.</span>


<span class="sd">    bag : numpy.array</span>
<span class="sd">        orignal bag data</span>
<span class="sd">    interp : numpy.array</span>
<span class="sd">        interpolated bag data (smoothed)</span>
<span class="sd">    pbag : numpy.array</span>
<span class="sd">        interpolated bag data (before smooth)</span>
<span class="sd">    poly : numpy.array</span>
<span class="sd">        binary raster of tif coverage</span>
<span class="sd">    uncr : numpy.array</span>
<span class="sd">        original uncertainty</span>
<span class="sd">    iuncrt : numpy.array</span>
<span class="sd">        interpolated uncertainty</span>
<span class="sd">    maxVal : numpy.array</span>
<span class="sd">        bag no-data value</span>
<span class="sd">    ioVal : numpy.array</span>
<span class="sd">        user option to include all data or interpolated data only</span>


<span class="sd">    Steps:</span>

<span class="sd">    1. Create a binary grid of tif dat, tpoly.</span>
<span class="sd">    2. Create a binary grid of bag data, bpoly.</span>
<span class="sd">    3. Create a combined grid of the &quot;complete coverage&quot; of data; cpoly, numpy.logical_or of bpoly, tpoly.</span>
<span class="sd">    4. Use bpoly to remove the bag coverage from the combined &quot;complete coverage&quot;; dpoly, numpy.logical_xor of bpoly, cpoly.</span>
<span class="sd">    5. Use dpoly to determine where interpolated data can be applied and apply original bag data everywhere else; ibag, numpy.where of dpoly, pbag, bag.</span>
<span class="sd">    6. Create a binary grid of ibag, npoly.</span>
<span class="sd">    7. Use npoly and dpoly to create a binary grid where only data is present; fpoly, numpy.logical_and of dpoly, nopoly.</span>
<span class="sd">    8. Finalize results by using fpoly to apply interpolated data where appropriate and original bag data everywhere else.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    grids : list</span>
<span class="sd">        List of original data objects for BAG and GeoTiff data</span>
<span class="sd">    ugrids : list</span>
<span class="sd">        List of interpolated data objects for BAG depth and uncertainty data</span>
<span class="sd">    ioVal : int, bool</span>
<span class="sd">        User input. Determines whether origninal and interpolated or only</span>
<span class="sd">        interpolated data is output</span>
<span class="sd">    debug : int, bool</span>
<span class="sd">        Whether or not polyList includes all or only the last step in the</span>
<span class="sd">        evaluation process</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nbag : numpy.array</span>
<span class="sd">        Interpolated BAG bathymetry</span>
<span class="sd">    nunc : numpy.array</span>
<span class="sd">        Interpolated BAG uncertainty</span>
<span class="sd">    polyList : list</span>
<span class="sd">        List of numpy.array objects containting all or only the last step in</span>
<span class="sd">        the evaluation process</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;rePrint&#39;</span><span
            class="p">,</span> <span class="n">_dt</span><span class="o">.</span><span class="n">now</span><span
            class="p">())</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">maxVal</span><span class="p">)</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="n">grids</span><span class="p">[</span><span
            class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]</span>
    <span class="n">bag</span> <span class="o">=</span> <span class="n">grids</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span
            class="mi">1</span><span class="p">]</span>
    <span class="n">uncr</span> <span class="o">=</span> <span class="n">grids</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span
            class="mi">2</span><span class="p">]</span>
    <span class="n">interp</span> <span class="o">=</span> <span class="n">ugrids</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span>
    <span class="n">iuncrt</span> <span class="o">=</span> <span class="n">ugrids</span><span class="p">[</span><span
            class="mi">1</span><span class="p">]</span>
    <span class="n">pbag</span> <span class="o">=</span> <span class="n">ugrids</span><span class="p">[</span><span
            class="mi">2</span><span class="p">]</span>
    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span
            class="n">bag</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1">## 1</span>
    <span class="n">tpoly</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">nan_to_num</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
    <span class="n">tpoly</span> <span class="o">=</span> <span class="p">(</span><span class="n">tpoly</span> <span
            class="o">&lt;</span> <span class="n">maxVal</span><span class="p">)</span><span class="o">.</span><span
            class="n">astype</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span
            class="n">int</span><span class="p">)</span>
    <span class="c1">## 2</span>
    <span class="n">bpoly</span> <span class="o">=</span> <span class="p">(</span><span class="n">bag</span> <span
            class="o">&lt;</span> <span class="n">maxVal</span><span class="p">)</span><span class="o">.</span><span
            class="n">astype</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span
            class="n">int</span><span class="p">)</span>
    <span class="c1">## 3</span>
    <span class="n">cpoly</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">logical_or</span><span class="p">(</span><span class="n">bpoly</span><span
            class="p">,</span> <span class="n">tpoly</span><span class="p">)</span>
    <span class="c1">## 4</span>
    <span class="n">dpoly</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">logical_xor</span><span class="p">(</span><span class="n">bpoly</span><span
            class="p">,</span> <span class="n">cpoly</span><span class="p">)</span>
    <span class="c1">## 5</span>
    <span class="n">ibag</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">where</span><span class="p">(</span><span class="n">dpoly</span><span class="p">,</span> <span
            class="n">pbag</span><span class="p">,</span> <span class="n">bag</span><span class="p">)</span>
    <span class="c1">## 6</span>
    <span class="n">npoly</span> <span class="o">=</span> <span class="p">(</span><span class="n">ibag</span> <span
            class="o">&lt;</span> <span class="n">maxVal</span><span class="p">)</span><span class="o">.</span><span
            class="n">astype</span><span class="p">(</span><span class="n">_np</span><span class="o">.</span><span
            class="n">int</span><span class="p">)</span>
    <span class="c1">## 7</span>
    <span class="n">fpoly</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">logical_and</span><span class="p">(</span><span class="n">dpoly</span><span
            class="p">,</span> <span class="n">npoly</span><span class="p">)</span>
    <span class="c1">## 8</span>
    <span class="k">if</span> <span class="n">ioVal</span> <span class="o">==</span> <span class="kc">False</span><span
            class="p">:</span>
        <span class="n">nbag</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">where</span><span class="p">(</span><span class="n">fpoly</span><span class="p">,</span> <span
            class="n">interp</span><span class="p">,</span> <span class="n">bag</span><span class="p">)</span>
        <span class="n">nunc</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">where</span><span class="p">(</span><span class="n">fpoly</span><span class="p">,</span> <span
            class="n">iuncrt</span><span class="p">,</span> <span class="n">uncr</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ioVal</span> <span class="o">==</span> <span class="kc">True</span><span
            class="p">:</span>
        <span class="n">nbag</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">where</span><span class="p">(</span><span class="n">fpoly</span><span class="p">,</span> <span
            class="n">interp</span><span class="p">,</span> <span class="n">maxVal</span><span class="p">)</span>
        <span class="n">nunc</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">where</span><span class="p">(</span><span class="n">fpoly</span><span class="p">,</span> <span
            class="n">iuncrt</span><span class="p">,</span> <span class="n">maxVal</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">,</span> <span
            class="n">_dt</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="mi">0</span><span
            class="p">:</span>
        <span class="n">polyList</span> <span class="o">=</span> <span class="p">[</span><span
            class="n">fpoly</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">nbag</span><span class="p">,</span> <span
            class="n">nunc</span><span class="p">,</span> <span class="n">polyList</span>
    <span class="k">elif</span> <span class="n">debug</span> <span class="o">==</span> <span class="mi">1</span><span
            class="p">:</span>
        <span class="n">polyList</span> <span class="o">=</span> <span class="p">[</span><span
            class="n">tpoly</span><span class="p">,</span><span class="n">bpoly</span><span class="p">,</span><span
            class="n">cpoly</span><span class="p">,</span><span class="n">dpoly</span><span class="p">,</span><span
            class="n">npoly</span><span class="p">,</span><span class="n">fpoly</span><span class="p">,</span><span
            class="n">ibag</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">nbag</span><span class="p">,</span> <span
            class="n">nunc</span><span class="p">,</span> <span class="n">polyList</span></div>

<div class="viewcode-block" id="triangulateSurfaces"><a class="viewcode-back"
                                                        href="../index.html#autointerp.triangulateSurfaces">[docs]</a><span
        class="k">def</span> <span class="nf">triangulateSurfaces</span><span class="p">(</span><span
        class="n">grids</span><span class="p">,</span> <span class="n">combo</span><span class="p">,</span> <span
        class="n">vals</span><span class="p">,</span> <span class="n">uval</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interpolates input data and convolves the ouput of the interpolation</span>

<span class="sd">    Takes input BAG and GeoTiff objects; tile or complete data.  This data is</span>
<span class="sd">    used to inform the shape/size of the resulting output of the interpolation</span>
<span class="sd">    function. If combo and vals are empty, the interpolation process is skipped</span>
<span class="sd">    and the tile or complete data is passed back from the function. Otherwise,</span>
<span class="sd">    combo, vals and the shape of the BAG data input are passed to</span>
<span class="sd">    :func:`scipy.interpolate.griddata` and output to the variable &quot;grid_pre&quot;.</span>
<span class="sd">    The output of this function is also saved to a seperate variable &quot;grid&quot;</span>
<span class="sd">    while the original output is left untouched. The seperate output is then</span>
<span class="sd">    passed to :func:`astropy.convolution.convolve` to smooth the output.</span>

<span class="sd">    The uncertainty layer is calculated using uval and grid::</span>

<span class="sd">        &gt;&gt;&gt; m, b = uval</span>
<span class="sd">        &gt;&gt;&gt; uncr = (grid*m)+b</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    grids : list</span>
<span class="sd">        The BAG and GeoTiff objects</span>
<span class="sd">    combo : numpy.array</span>
<span class="sd">        Array of indecies where nodata values meet data values</span>
<span class="sd">        in order x, y</span>
<span class="sd">    vals : numpy.array</span>
<span class="sd">        Array of values where nodata values meet data values</span>
<span class="sd">        in order z</span>
<span class="sd">    uval : tuple</span>
<span class="sd">        Values for uncertainty calculation</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    grid : numpy.array</span>
<span class="sd">        The interpolated and convolved bathemetry</span>
<span class="sd">    uncr : numpy.array</span>
<span class="sd">        The calculated uncertainty from the interpolated and convolved</span>
<span class="sd">        bathemetry</span>
<span class="sd">    grid_pre : numpy.array</span>
<span class="sd">        The interpolated bathemetry before convolution is performed</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;triangulateSurfaces&#39;</span><span
            class="p">)</span>
    <span class="n">bagObj</span> <span class="o">=</span> <span class="n">grids</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">bag</span> <span class="o">=</span> <span class="n">bagObj</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">uncr</span> <span class="o">=</span> <span class="n">bagObj</span><span class="p">[</span><span
            class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">tifObj</span> <span class="o">=</span> <span class="n">grids</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="n">tifObj</span><span class="p">[</span><span
            class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">maxVal</span> <span class="o">=</span> <span class="n">maxValue</span><span class="p">(</span><span
            class="n">bag</span><span class="p">)</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">uval</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">bag</span><span
            class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span
            class="p">]),</span> <span class="n">_np</span><span class="o">.</span><span class="n">arange</span><span
            class="p">(</span><span class="n">bag</span><span class="o">.</span><span class="n">shape</span><span
            class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="o">=</span> <span
            class="n">_np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span
            class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">combo</span><span
            class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span
            class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span
            class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;try tri&#39;</span><span
            class="p">,</span> <span class="n">_dt</span><span class="o">.</span><span class="n">now</span><span
            class="p">())</span>
        <span class="n">grid_pre</span> <span class="o">=</span> <span class="n">_scipy</span><span
            class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span
            class="n">griddata</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span
            class="n">vals</span><span class="p">,</span> <span class="p">(</span><span class="n">xi</span><span
            class="p">,</span> <span class="n">yi</span><span class="p">),</span>
                                            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span
            class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span
            class="n">maxVal</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;done&#39;</span><span
            class="p">,</span> <span class="n">_dt</span><span class="o">.</span><span class="n">now</span><span
            class="p">())</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">grid_pre</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">asarray</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span
            class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span
            class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">grid</span><span class="o">.</span><span
            class="n">shape</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span
            class="n">shape</span><span class="p">)</span>
        <span class="n">grid</span><span class="p">[</span><span class="n">grid</span><span class="o">&gt;</span><span
            class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">nan</span>
        <span class="n">kernel</span> <span class="o">=</span> <span class="n">_apc</span><span class="o">.</span><span
            class="n">Gaussian2DKernel</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;interp&#39;</span><span
            class="p">)</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">_apc</span><span class="o">.</span><span
            class="n">convolve</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span
            class="n">kernel</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;interp done&#39;</span><span
            class="p">)</span>
        <span class="n">grid</span><span class="p">[</span><span class="n">_np</span><span class="o">.</span><span
            class="n">isnan</span><span class="p">(</span><span class="n">grid</span><span class="p">)]</span><span
            class="o">=</span><span class="n">maxVal</span>
        <span class="n">grid</span><span class="p">[</span><span class="n">grid</span><span class="o">&gt;=</span><span
            class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxVal</span>
        <span class="n">uncr</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid</span><span
            class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">+</span><span
            class="n">b</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">bag</span>
        <span class="n">uncr</span> <span class="o">=</span> <span class="n">uncr</span>
        <span class="n">grid_pre</span> <span class="o">=</span> <span class="n">bag</span>
    <span class="k">return</span> <span class="n">grid</span><span class="p">,</span> <span class="n">uncr</span><span
            class="p">,</span> <span class="n">grid_pre</span></div>

<div class="viewcode-block" id="bagSave"><a class="viewcode-back"
                                            href="../index.html#autointerp.bagSave">[docs]</a><span class="k">def</span> <span
        class="nf">bagSave</span><span class="p">(</span><span class="n">bag</span><span class="p">,</span> <span
        class="n">new</span><span class="p">,</span> <span class="n">tifs</span><span class="p">,</span> <span
        class="n">res</span><span class="p">,</span> <span class="n">ext</span><span class="p">,</span> <span class="n">path</span><span
        class="p">,</span> <span class="n">newu</span><span class="p">,</span> <span class="n">polyList</span><span
        class="p">,</span> <span class="n">ioVal</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Primary function for saving final products of the tool.</span>

<span class="sd">    Extended description of function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bag : list</span>
<span class="sd">        BAG file object</span>
<span class="sd">    new : numpy.array</span>
<span class="sd">        Origninal and interpolated BAG data or only interpolated data</span>
<span class="sd">    tifs : list</span>
<span class="sd">        GeoTiff file object</span>
<span class="sd">    res : float</span>
<span class="sd">        Resolution of input BAG data</span>
<span class="sd">    ext : list</span>
<span class="sd">        Extent of the input BAG data [NW, SE] in [x, y]</span>
<span class="sd">    path : str</span>
<span class="sd">        Output folder path</span>
<span class="sd">    newu : numpy.array</span>
<span class="sd">        Origninal and interpolated Uncertainty data or only interpolated data</span>
<span class="sd">    polyList : list</span>
<span class="sd">        List of binary grids generated by :func:`rePrint` for</span>
<span class="sd">        output for use in validating or debugging products</span>
<span class="sd">    ioVal : int, bool</span>
<span class="sd">        User input. Determines whether origninal and interpolated or only</span>
<span class="sd">        interpolated data is output</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">tif</span> <span class="ow">in</span> <span class="n">tifs</span><span
            class="p">:</span>
        <span class="n">gd_obj</span> <span class="o">=</span> <span class="n">_gdal</span><span class="o">.</span><span
            class="n">Open</span><span class="p">(</span><span class="n">tif</span><span class="p">[</span><span
            class="mi">1</span><span class="p">])</span>
        <span class="k">break</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;bagSave&#39;</span><span
            class="p">)</span>
    <span class="n">oextX</span><span class="p">,</span> <span class="n">oextY</span> <span class="o">=</span> <span
            class="n">bag</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">nx</span> <span class="o">=</span> <span
            class="n">ext</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sy</span><span class="p">,</span> <span class="n">sx</span> <span class="o">=</span> <span
            class="n">ext</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span
            class="p">]</span>
    <span class="n">reso</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span
            class="n">res</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span
            class="n">sy</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span
            class="n">ny</span><span class="p">)</span>
    <span class="n">gtran</span> <span class="o">=</span> <span class="p">(</span><span class="n">ny</span><span
            class="p">,</span> <span class="n">reso</span><span class="p">,</span> <span class="mf">0.0</span><span
            class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mf">0.0</span><span
            class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">reso</span><span
            class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">gtran</span><span class="p">)</span>
    <span class="n">fName</span> <span class="o">=</span> <span class="n">bag</span><span class="p">[</span><span
            class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span
            class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span
            class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">fName</span><span class="p">)</span>
    <span class="n">split</span> <span class="o">=</span> <span class="n">fName</span><span class="o">.</span><span
            class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span
            class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">res</span> <span class="o">&lt;</span> <span class="mi">1</span><span
            class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span
            class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="o">*</span><span
            class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;cm&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span
            class="n">res</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;m&#39;</span>
    <span class="k">if</span> <span class="n">ioVal</span> <span class="o">==</span> <span class="mi">1</span><span
            class="p">:</span>
        <span class="n">bagName</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span
            class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span> <span
            class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">split</span><span
            class="p">])</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span
            class="o">+</span> <span class="n">res</span> <span class="o">+</span> <span class="s1">&#39;_INTERP_ONLY&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bagName</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span
            class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">x</span> <span
            class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">split</span><span
            class="p">])</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span
            class="o">+</span> <span class="n">res</span> <span class="o">+</span> <span class="s1">&#39;_INTERP_FULL&#39;</span>
    <span class="n">outputpath2</span> <span class="o">=</span> <span class="n">path</span> <span
            class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span
            class="s1">&#39;</span> <span class="o">+</span> <span class="n">bagName</span> <span
            class="o">+</span> <span class="s1">&#39;.bag&#39;</span>
<span class="c1">#    print(outputpath)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="c1">#        if _os.path.exists(outputpath):</span>
<span class="c1">#            _os.remove(outputpath)</span>
<span class="c1">#        elif not _os.path.exists(outputpath):</span>
<span class="c1">#            break</span>
        <span class="k">if</span> <span class="n">_os</span><span class="o">.</span><span class="n">path</span><span
            class="o">.</span><span class="n">exists</span><span class="p">(</span><span
            class="n">outputpath2</span><span class="p">):</span>
            <span class="n">_os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span
            class="n">outputpath2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">_os</span><span class="o">.</span><span
            class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span
            class="n">outputpath2</span><span class="p">):</span>
            <span class="k">break</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span
            class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">polyList</span><span
            class="p">)):</span>
        <span class="n">outputpath</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span
            class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span
            class="o">+</span> <span class="n">bagName</span> <span class="o">+</span> <span
            class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span
            class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">+</span><span
            class="s1">&#39;.tif&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">outputpath</span><span class="p">)</span>
        <span class="n">write_raster</span><span class="p">(</span><span class="n">polyList</span><span
            class="p">[</span><span class="n">num</span><span class="p">],</span> <span class="n">gtran</span><span
            class="p">,</span> <span class="n">gd_obj</span><span class="p">,</span> <span
            class="n">outputpath</span><span class="p">,</span>
                     <span class="n">dtype</span><span class="o">=</span><span class="n">_gdal</span><span
            class="o">.</span><span class="n">GDT_Float64</span><span class="p">,</span> <span
            class="n">nodata</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span
            class="n">options</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;COMPRESS=LZW&#39;</span> <span
            class="p">])</span>
    <span class="n">polyList</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span
            class="n">bag</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span
            class="n">outputpath2</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">_tb</span><span class="o">.</span><span class="n">open_file</span><span
            class="p">(</span><span class="n">outputpath2</span><span class="p">,</span> <span
            class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span
            class="p">)</span> <span class="k">as</span> <span class="n">bagfile</span><span class="p">:</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">flipud</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
        <span class="n">bagfile</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span
            class="n">BAG_root</span><span class="o">.</span><span class="n">elevation</span><span
            class="p">[:,:]</span> <span class="o">=</span> <span class="n">new</span>
        <span class="n">newu</span> <span class="o">=</span> <span class="n">_np</span><span class="o">.</span><span
            class="n">flipud</span><span class="p">(</span><span class="n">newu</span><span class="p">)</span>
        <span class="n">bagfile</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span
            class="n">BAG_root</span><span class="o">.</span><span class="n">uncertainty</span><span
            class="p">[:,:]</span> <span class="o">=</span> <span class="n">newu</span>
        <span class="k">if</span> <span class="n">ioVal</span> <span class="o">==</span> <span class="mi">1</span><span
            class="p">:</span>
            <span class="n">bagfile</span><span class="o">.</span><span class="n">root</span><span
            class="o">.</span><span class="n">BAG_root</span><span class="o">.</span><span
            class="n">tracking_list</span><span class="o">.</span><span class="n">remove_rows</span><span
            class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">bagfile</span><span
            class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">BAG_root</span><span
            class="o">.</span><span class="n">tracking_list</span><span class="o">.</span><span
            class="n">nrows</span><span class="p">)</span>
        <span class="n">bagfile</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">bagfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">gd_obj</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="sliceFinder"><a class="viewcode-back"
                                                href="../index.html#autointerp.sliceFinder">[docs]</a><span class="k">def</span> <span
        class="nf">sliceFinder</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span
        class="n">res</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span
        class="n">var</span><span class="o">=</span><span class="mi">5000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Uses the file size of the bag to determine if the grid should be tiled.</span>
<span class="sd">    If the file is less than 100Mb, the file will not be tiled.  If the file is</span>
<span class="sd">    large enough to tile, the number of tiles and index size of each tile will</span>
<span class="sd">    be calculated based on the ratio of the total size of each array.</span>

<span class="sd">    yChunk = 5000\*sqrt(height/width)</span>
<span class="sd">    xChunk = 5000\*sqrt(width/height)</span>

<span class="sd">    ny = _np.ceil(height/yChunk)</span>
<span class="sd">    nx = _np.ceil(width/xChunk)</span>

<span class="sd">    tiles = nx\*ny</span>

<span class="sd">    chunkgird is both the arrangement of tiles in relation to the grid and the</span>
<span class="sd">    order in which the tiles are processed.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    value : int</span>
<span class="sd">        Size of the input BAG file</span>
<span class="sd">    res : float</span>
<span class="sd">        Resolution of the input BAG data</span>
<span class="sd">    shape : tuple</span>
<span class="sd">        Dimensions of the input BAG data (y, x)</span>
<span class="sd">    var : int, optional</span>
<span class="sd">        Arbitrary value for determining chunk size</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tiles : int</span>
<span class="sd">        Number of tiles used to process the data</span>
<span class="sd">    chunkGrid : numpy.array, None</span>
<span class="sd">        The arrangement of tiles in relation to the grid and the</span>
<span class="sd">        order in which the tiles are proceced</span>
<span class="sd">    sliceInfo : list, None</span>
<span class="sd">        The value for the tile buffer and dimensions of each tile</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; chunkGrid = _np.arrange(tiles).reshape((ny, nx))</span>
<span class="sd">    array([[ 0,  1,  2,  3,  4,  5],</span>
<span class="sd">           [ 6,  7,  8,  9, 10, 11],</span>
<span class="sd">           [12, 13, 14, 15, 16, 17],</span>
<span class="sd">           [18, 19, 20, 21, 22, 23],</span>
<span class="sd">           [24, 25, 26, 27, 28, 29],</span>
<span class="sd">           [30, 31, 32, 33, 34, 35]])</span>
<span class="sd">    # 36 Total Tiles</span>
<span class="sd">    # Tile 3 is index [0,3] and has a value of 2</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;sliceFinder&#39;</span><span
            class="p">)</span>
    <span class="k">if</span> <span class="n">res</span> <span class="o">&lt;</span> <span class="mi">1</span><span
            class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mi">25</span><span class="o">/</span><span
            class="n">res</span>
    <span class="k">elif</span> <span class="n">res</span> <span class="o">&gt;</span> <span class="mi">1</span><span
            class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;=</span> <span
            class="mi">100000</span><span class="p">:</span>
        <span class="n">tiles</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">tiles</span><span class="p">,</span> <span
            class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="n">size</span> <span class="o">&gt;</span> <span
            class="mi">100000</span><span class="p">:</span>
        <span class="n">yChunk</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
            class="n">_np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span
            class="n">var</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span
            class="n">sqrt</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">shape</span><span
            class="p">[</span><span class="mi">1</span><span class="p">])))</span> <span class="c1">#y</span>
        <span class="n">xChunk</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
            class="n">_np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span
            class="n">var</span><span class="o">*</span><span class="n">_np</span><span class="o">.</span><span
            class="n">sqrt</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span
            class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">shape</span><span
            class="p">[</span><span class="mi">0</span><span class="p">])))</span> <span class="c1">#x</span>
        <span class="n">ny</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
            class="n">_np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span
            class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span
            class="o">/</span><span class="n">yChunk</span><span class="p">))</span> <span class="c1">#ny</span>
        <span class="n">nx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
            class="n">_np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span
            class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span
            class="o">/</span><span class="n">xChunk</span><span class="p">))</span> <span class="c1">#nx</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span
            class="n">nx</span><span class="p">)</span>
        <span class="n">tiles</span> <span class="o">=</span> <span class="n">ny</span><span class="o">*</span><span
            class="n">nx</span>
        <span class="n">chunckGrid</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">tiles</span><span
            class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span
            class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">))</span>
        <span class="n">sliceInfo</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span
            class="p">,</span> <span class="n">yChunk</span><span class="p">,</span> <span class="n">xChunk</span><span
            class="p">]</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">tiles</span><span class="p">,</span> <span
            class="n">chunckGrid</span><span class="p">,</span> <span class="n">sliceInfo</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tiles</span><span class="p">,</span> <span
            class="n">chunckGrid</span><span class="p">,</span> <span class="n">sliceInfo</span></div>


<div class="viewcode-block" id="interp"><a class="viewcode-back" href="../index.html#autointerp.interp">[docs]</a><span
        class="k">def</span> <span class="nf">interp</span><span class="p">(</span><span class="n">grids</span><span
        class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">res</span><span
        class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">uval</span><span
        class="p">,</span> <span class="n">ioVal</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Summary of function</span>

<span class="sd">    Extended description of function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    grids : list</span>
<span class="sd">        The BAG and GeoTiff objects</span>
<span class="sd">    size : int</span>
<span class="sd">        Size of the input BAG file</span>
<span class="sd">    res : float</span>
<span class="sd">        Resolution of the input BAG data</span>
<span class="sd">    shape : tuple</span>
<span class="sd">        Dimensions of the input BAG data (y, x)</span>
<span class="sd">    uval : tuple</span>
<span class="sd">        Values for uncertainty calculation</span>
<span class="sd">    ioVal : int, bool</span>
<span class="sd">        User input. Determines whether origninal and interpolated or only</span>
<span class="sd">        interpolated data is output</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ugrids : list</span>
<span class="sd">        Complete interpolated data as unitedBag, unitedUncr, and unitedPre</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">z</span><span class="p">,</span> <span class="n">chunkGrid</span><span class="p">,</span> <span
            class="n">sliceInfo</span> <span class="o">=</span> <span class="n">sliceFinder</span><span
            class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">res</span><span
            class="p">,</span> <span class="n">shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">z</span> <span class="o">&gt;</span> <span class="mi">1</span><span
            class="p">:</span>
        <span class="n">tifObjras</span> <span class="o">=</span> <span class="n">grids</span><span
            class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span
            class="mi">1</span><span class="p">]</span>
        <span class="n">bagObjras</span> <span class="o">=</span> <span class="n">grids</span><span
            class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span
            class="mi">1</span><span class="p">]</span>
        <span class="n">uncObjras</span> <span class="o">=</span> <span class="n">grids</span><span
            class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span
            class="mi">2</span><span class="p">]</span>
        <span class="n">unitedBag</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span
            class="n">bagObjras</span><span class="p">)</span>
        <span class="n">unitedUncr</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span
            class="n">bagObjras</span><span class="p">)</span>
        <span class="n">unitedPre</span> <span class="o">=</span> <span class="n">_np</span><span
            class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span
            class="n">bagObjras</span><span class="p">)</span>
        <span class="n">bagShape</span> <span class="o">=</span> <span class="n">bagObjras</span><span
            class="o">.</span><span class="n">shape</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span
            class="n">tifObjras</span><span class="p">[::</span><span class="mi">100</span><span
            class="p">,::</span><span class="mi">100</span><span class="p">])</span>
        <span class="n">_plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ySlice</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="n">chunkGrid</span><span class="o">.</span><span
            class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">xSlice</span> <span class="ow">in</span> <span
            class="nb">range</span><span class="p">(</span><span class="n">chunkGrid</span><span class="o">.</span><span
            class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="n">_dt</span><span
            class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">ySlice</span><span
            class="p">,</span> <span class="n">xSlice</span>
                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span
            class="se">\n</span><span class="s1">Tile&#39;</span><span class="p">,</span> <span
            class="n">chunkGrid</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span
            class="o">+</span><span class="mi">1</span><span class="p">,</span> <span
            class="s1">&#39;of&#39;</span><span class="p">,</span> <span class="n">z</span><span
            class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span
            class="n">ts</span><span class="p">)</span>
                <span class="n">tile</span> <span class="o">=</span> <span class="n">chunk</span><span
            class="p">(</span><span class="n">sliceInfo</span><span class="p">,</span> <span class="n">index</span><span
            class="p">,</span> <span class="n">bagShape</span><span class="p">)</span>
                <span class="n">tiffTile</span> <span class="o">=</span> <span class="n">tifObjras</span><span
            class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">yMin</span><span
            class="p">:</span><span class="n">tile</span><span class="o">.</span><span class="n">yMax</span><span
            class="p">,</span><span class="n">tile</span><span class="o">.</span><span class="n">xMin</span><span
            class="p">:</span><span class="n">tile</span><span class="o">.</span><span class="n">xMax</span><span
            class="p">]</span>
<span class="c1">#                tiffTile[tiffTile &lt; 0] = chunkGrid[index]</span>
<span class="c1">#                tiffTile[tiffTile &gt; 0] = -chunkGrid[index]</span>
                <span class="n">bathTile</span> <span class="o">=</span> <span class="n">bagObjras</span><span
            class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">yMin</span><span
            class="p">:</span><span class="n">tile</span><span class="o">.</span><span class="n">yMax</span><span
            class="p">,</span><span class="n">tile</span><span class="o">.</span><span class="n">xMin</span><span
            class="p">:</span><span class="n">tile</span><span class="o">.</span><span class="n">xMax</span><span
            class="p">]</span>
<span class="c1">#                bathTile[bathTile &lt; 1] = chunkGrid[index]</span>
<span class="c1">#                bathTile[tiffTile &gt; 0] = -chunkGrid[index]</span>
                <span class="n">uncrTile</span> <span class="o">=</span> <span class="n">uncObjras</span><span
            class="p">[</span><span class="n">tile</span><span class="o">.</span><span class="n">yMin</span><span
            class="p">:</span><span class="n">tile</span><span class="o">.</span><span class="n">yMax</span><span
            class="p">,</span><span class="n">tile</span><span class="o">.</span><span class="n">xMin</span><span
            class="p">:</span><span class="n">tile</span><span class="o">.</span><span class="n">xMax</span><span
            class="p">]</span>
                <span class="n">gridSplit</span> <span class="o">=</span> <span class="p">[</span><span
            class="n">grids</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span
            class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">grids</span><span
            class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span
            class="o">-</span><span class="mi">2</span><span class="p">]]</span>
                <span class="n">gridSplit</span><span class="p">[</span><span class="mi">0</span><span
            class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
            class="n">tiffTile</span><span class="p">)</span>
                <span class="n">gridSplit</span><span class="p">[</span><span class="o">-</span><span
            class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span
            class="p">(</span><span class="n">uncrTile</span><span class="p">)</span>
                <span class="n">gridSplit</span><span class="p">[</span><span class="o">-</span><span
            class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span
            class="p">(</span><span class="n">bathTile</span><span class="p">)</span>
                <span class="n">tiffTile</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">bathTile</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">uncrTile</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">combo</span><span class="p">,</span> <span class="n">vals</span> <span
            class="o">=</span> <span class="n">comboGrid</span><span class="p">(</span><span
            class="n">gridSplit</span><span class="p">)</span>
                <span class="nb">print</span> <span class="p">(</span><span
            class="s1">&#39;interp is next&#39;</span><span class="p">)</span>
                <span class="n">newBag</span><span class="p">,</span> <span class="n">newUncr</span><span
            class="p">,</span> <span class="n">preBag</span> <span class="o">=</span> <span class="n">triangulateSurfaces</span><span
            class="p">(</span><span class="n">gridSplit</span><span class="p">,</span> <span class="n">combo</span><span
            class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">uval</span><span
            class="p">)</span>
                <span class="n">unitedBag</span><span class="p">[</span><span class="n">tile</span><span
            class="o">.</span><span class="n">yBMin</span><span class="p">:</span><span class="n">tile</span><span
            class="o">.</span><span class="n">yBMax</span><span class="p">,</span><span class="n">tile</span><span
            class="o">.</span><span class="n">xBMin</span><span class="p">:</span><span class="n">tile</span><span
            class="o">.</span><span class="n">xBMax</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">newBag</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span
            class="n">yIMin</span><span class="p">:</span><span class="n">tile</span><span class="o">.</span><span
            class="n">yIMax</span><span class="p">,</span><span class="n">tile</span><span class="o">.</span><span
            class="n">xIMin</span><span class="p">:</span><span class="n">tile</span><span class="o">.</span><span
            class="n">xIMax</span><span class="p">]</span>
                <span class="n">unitedUncr</span><span class="p">[</span><span class="n">tile</span><span
            class="o">.</span><span class="n">yBMin</span><span class="p">:</span><span class="n">tile</span><span
            class="o">.</span><span class="n">yBMax</span><span class="p">,</span><span class="n">tile</span><span
            class="o">.</span><span class="n">xBMin</span><span class="p">:</span><span class="n">tile</span><span
            class="o">.</span><span class="n">xBMax</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">newUncr</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span
            class="n">yIMin</span><span class="p">:</span><span class="n">tile</span><span class="o">.</span><span
            class="n">yIMax</span><span class="p">,</span><span class="n">tile</span><span class="o">.</span><span
            class="n">xIMin</span><span class="p">:</span><span class="n">tile</span><span class="o">.</span><span
            class="n">xIMax</span><span class="p">]</span>
                <span class="n">unitedPre</span><span class="p">[</span><span class="n">tile</span><span
            class="o">.</span><span class="n">yBMin</span><span class="p">:</span><span class="n">tile</span><span
            class="o">.</span><span class="n">yBMax</span><span class="p">,</span><span class="n">tile</span><span
            class="o">.</span><span class="n">xBMin</span><span class="p">:</span><span class="n">tile</span><span
            class="o">.</span><span class="n">xBMax</span><span class="p">]</span> <span class="o">=</span> <span
            class="n">preBag</span><span class="p">[</span><span class="n">tile</span><span class="o">.</span><span
            class="n">yIMin</span><span class="p">:</span><span class="n">tile</span><span class="o">.</span><span
            class="n">yIMax</span><span class="p">,</span><span class="n">tile</span><span class="o">.</span><span
            class="n">xIMin</span><span class="p">:</span><span class="n">tile</span><span class="o">.</span><span
            class="n">xIMax</span><span class="p">]</span>
<span class="c1">#                unitedBag[tile.yBMin:tile.yBMax,tile.xBMin:tile.xBMax] = bathTile[tile.yIMin:tile.yIMax,tile.xIMin:tile.xIMax]</span>
<span class="c1">#                unitedPre[tile.yBMin:tile.yBMax,tile.xBMin:tile.xBMax] = tiffTile[tile.yIMin:tile.yIMax,tile.xIMin:tile.xIMax]</span>
                <span class="n">newBag</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">newUncr</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">preBag</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">td</span> <span class="o">=</span> <span class="n">_dt</span><span
            class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="n">tdelt</span> <span class="o">=</span> <span class="n">td</span> <span class="o">-</span> <span
            class="n">ts</span>
                <span class="nb">print</span> <span class="p">(</span><span
            class="s1">&#39;Tile complete -&#39;</span><span class="p">,</span> <span class="n">td</span><span
            class="p">,</span> <span class="s1">&#39;| Tile took:&#39;</span><span class="p">,</span> <span class="n">tdelt</span><span
            class="p">)</span>
        <span class="n">tifObjras</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">bagObjras</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">uncObjras</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">_dt</span><span class="o">.</span><span
            class="n">now</span><span class="p">()</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span
            class="se">\n</span><span class="s1">Tile 1 of 1 -&#39;</span><span class="p">,</span> <span
            class="n">ts</span><span class="p">)</span>
        <span class="n">combo</span><span class="p">,</span> <span class="n">vals</span> <span class="o">=</span> <span
            class="n">comboGrid</span><span class="p">(</span><span class="n">grids</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;interp is next&#39;</span><span
            class="p">)</span>
        <span class="n">unitedBag</span><span class="p">,</span> <span class="n">unitedUncr</span><span
            class="p">,</span> <span class="n">unitedPre</span> <span class="o">=</span> <span class="n">triangulateSurfaces</span><span
            class="p">(</span><span class="n">grids</span><span class="p">,</span> <span class="n">combo</span><span
            class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">uval</span><span
            class="p">)</span>
        <span class="n">td</span> <span class="o">=</span> <span class="n">_dt</span><span class="o">.</span><span
            class="n">now</span><span class="p">()</span>
        <span class="n">tdelt</span> <span class="o">=</span> <span class="n">td</span> <span class="o">-</span> <span
            class="n">ts</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Tile complete -&#39;</span><span
            class="p">,</span> <span class="n">td</span><span class="p">,</span> <span
            class="s1">&#39;| Tile took:&#39;</span><span class="p">,</span> <span class="n">tdelt</span><span
            class="p">)</span>
<span class="c1">#    _plt.imshow(unitedBag[::100,::100])</span>
<span class="c1">#    _plt.show()</span>
<span class="c1">#    _plt.imshow(unitedPre[::100,::100])</span>
<span class="c1">#    _plt.show()</span>
    <span class="n">ugrids</span> <span class="o">=</span> <span class="p">[</span><span class="n">unitedBag</span><span
            class="p">,</span> <span class="n">unitedUncr</span><span class="p">,</span> <span
            class="n">unitedPre</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ugrids</span></div>


<div class="viewcode-block" id="main"><a class="viewcode-back" href="../index.html#autointerp.main">[docs]</a><span
        class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">bagPath</span><span
        class="p">,</span> <span class="n">tifPath</span><span class="p">,</span> <span class="n">desPath</span><span
        class="p">,</span> <span class="n">catzoc</span><span class="p">,</span> <span class="n">ioVal</span><span
        class="p">):</span>
    <span class="sd">&quot;&quot;&quot;main function of the interpolation process.  This function handles</span>
<span class="sd">    the flow of data in input, tiling, interpolation, and reintigration of the</span>
<span class="sd">    final grid.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bagPath : string</span>
<span class="sd">        File path of the input BAG file</span>
<span class="sd">    tifPath : list</span>
<span class="sd">        File paths of the input GeoTiff files</span>
<span class="sd">    desPath : string</span>
<span class="sd">        Folder path for the output files</span>
<span class="sd">    catzoc : string</span>
<span class="sd">        Selection of catzoc grade used to calculate interpolated uncertainty</span>
<span class="sd">    ioVal : int, bool</span>
<span class="sd">        User input. Determines whether origninal and interpolated or only</span>
<span class="sd">        interpolated data is output</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    msg : string</span>
<span class="sd">        String with the total time it took to complete the process</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">_dt</span><span class="o">.</span><span
            class="n">now</span><span class="p">()</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;start&#39;</span><span
            class="p">,</span> <span class="n">start</span><span class="p">)</span>
    <span class="n">tifFiles</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span
            class="n">getTifElev</span><span class="p">(</span><span class="n">tifPath</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tifFiles</span><span
            class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">tifGrids</span><span class="p">,</span> <span class="n">extent</span> <span
            class="o">=</span> <span class="n">alignTifs</span><span class="p">(</span><span
            class="n">tifFiles</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tif</span> <span class="ow">in</span> <span class="n">tifGrids</span><span
            class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">tif</span><span
            class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span
            class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tifGrids</span> <span class="o">=</span> <span class="n">tifFiles</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">tifGrids</span><span class="p">)</span>
        <span class="n">extent</span> <span class="o">=</span> <span class="n">tifGrids</span><span
            class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span
            class="p">]</span>
    <span class="n">comboTif</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span
            class="n">nameh5</span><span class="p">,</span> <span class="n">targs</span> <span class="o">=</span> <span
            class="n">polyTifVals</span><span class="p">(</span><span class="n">tifGrids</span><span class="p">,</span> <span
            class="n">desPath</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span
            class="n">extent</span><span class="p">)</span>
    <span class="n">_plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span
            class="n">comboTif</span><span class="p">[::</span><span class="mi">100</span><span
            class="p">,::</span><span class="mi">100</span><span class="p">])</span>
    <span class="n">_plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#    tifGrids = None</span>
    <span class="n">comboArr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span
            class="p">,</span> <span class="n">nameh5</span><span class="p">,</span> <span class="n">extent</span><span
            class="p">,</span> <span class="n">comboTif</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span
            class="s1">done with tif section</span><span class="se">\n</span><span class="s1">&#39;</span><span
            class="p">)</span>

    <span class="n">bag</span><span class="p">,</span> <span class="n">maxVal</span><span class="p">,</span> <span
            class="n">bagfile</span> <span class="o">=</span> <span class="n">getBagLyrs</span><span
            class="p">(</span><span class="n">bagPath</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bag</span><span class="p">,</span> <span
            class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">bag</span><span class="p">[</span><span
            class="mi">3</span><span class="p">]</span>
    <span class="n">res</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span
            class="n">ext</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span
            class="n">alignGrids</span><span class="p">(</span><span class="n">bag</span><span class="p">,</span> <span
            class="n">comboArr</span><span class="p">,</span> <span class="n">maxVal</span><span
            class="p">,</span> <span class="n">targs</span><span class="p">)</span>
<span class="c1">#    bagfile.close</span>

    <span class="c1">##  Tiling Begins</span>
    <span class="n">uval</span> <span class="o">=</span> <span class="n">catZones</span><span class="o">.</span><span
            class="n">get</span><span class="p">(</span><span class="n">catzoc</span><span class="p">)</span>
    <span class="n">ugrids</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span><span
            class="n">grids</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span
            class="n">res</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span
            class="n">uval</span><span class="p">,</span> <span class="n">ioVal</span><span class="p">)</span>

    <span class="c1">## Tiling Ends</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span
            class="s1">saving is next</span><span class="se">\n</span><span class="s1">&#39;</span><span
            class="p">)</span>
    <span class="n">saveBag</span><span class="p">,</span> <span class="n">saveUnc</span><span class="p">,</span> <span
            class="n">polyList</span> <span class="o">=</span> <span class="n">rePrint</span><span
            class="p">(</span><span class="n">grids</span><span class="p">,</span> <span class="n">ugrids</span><span
            class="p">,</span> <span class="n">maxVal</span><span class="p">,</span> <span class="n">ioVal</span><span
            class="p">)</span>
    <span class="n">grids</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">ugrids</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">bagSave</span><span class="p">(</span><span class="n">bag</span><span class="p">,</span> <span
            class="n">saveBag</span><span class="p">,</span> <span class="n">tifGrids</span><span
            class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">ext</span><span
            class="p">,</span> <span class="n">desPath</span><span class="p">,</span> <span
            class="n">saveUnc</span><span class="p">,</span> <span class="n">polyList</span><span
            class="p">,</span> <span class="n">ioVal</span><span class="p">)</span>
    <span class="n">done</span> <span class="o">=</span> <span class="n">_dt</span><span class="o">.</span><span
            class="n">now</span><span class="p">()</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;acually done&#39;</span><span class="p">,</span> <span
            class="n">done</span><span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">done</span> <span class="o">-</span> <span
            class="n">start</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Done! Took: &#39;</span> <span
            class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">delta</span><span
            class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="chunk"><a class="viewcode-back" href="../index.html#autointerp.chunk">[docs]</a><span
        class="k">class</span> <span class="nc">chunk</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;chunk() serves as the data container for individual tile data. It&#39;s</span>
<span class="sd">    inputs inlcude sliceInfo=[buffer, height, width], chunkSlice=tile[y,x]</span>
<span class="sd">    (tile position), and the total height and width of the BAG grid.  This</span>
<span class="sd">    information is then used to calculate the indices of each tile (with and</span>
<span class="sd">    without a buffer) and the indices of the data within the buffered tiles.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">yMin</span><span class="p">,</span> <span class="n">yMax</span><span class="p">,</span> <span
            class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span> <span class="o">=</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">yBMin</span><span class="p">,</span> <span class="n">yBMax</span><span class="p">,</span> <span
            class="n">xBMin</span><span class="p">,</span> <span class="n">xBMax</span> <span class="o">=</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">yIMin</span><span class="p">,</span> <span class="n">yIMax</span><span class="p">,</span> <span
            class="n">xIMin</span><span class="p">,</span> <span class="n">xIMax</span> <span class="o">=</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
            class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span
            class="p">,</span> <span class="n">sliceInfo</span><span class="p">,</span> <span
            class="n">chunkSlice</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Breaks the input sliceInfo into individual variables and starts the</span>
<span class="sd">        calculation function calcSlice()</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="n">sliceInfo</span><span
            class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">yChunk</span> <span class="o">=</span> <span class="n">sliceInfo</span><span
            class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">xChunk</span> <span class="o">=</span> <span class="n">sliceInfo</span><span
            class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calcSlice</span><span
            class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">yChunk</span><span
            class="p">,</span> <span class="n">xChunk</span><span class="p">,</span> <span
            class="n">chunkSlice</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>

<div class="viewcode-block" id="chunk.calcSlice"><a class="viewcode-back"
                                                    href="../index.html#autointerp.chunk.calcSlice">[docs]</a>    <span
        class="k">def</span> <span class="nf">calcSlice</span><span class="p">(</span><span class="bp">self</span><span
        class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">yChunk</span><span
        class="p">,</span> <span class="n">xChunk</span><span class="p">,</span> <span class="n">chunkSlice</span><span
        class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Takes the complete information of a give individual tile and</span>
<span class="sd">        calculates the indices of each tile (with and without a buffer) and the</span>
<span class="sd">        indices of the data within the buffered tiles.</span>


<span class="sd">        The calculations are the same, regardless of axis:</span>

<span class="sd">        1. Determination of the data (with a buffer) for interpolation.::</span>

<span class="sd">            Min = 0 #(for tiles on the upper or right borders)</span>
<span class="sd">            #or</span>
<span class="sd">            Min = (chunk \* index) - buffer</span>
<span class="sd">            Max = chunk \* (inex + 1) + buffer</span>
<span class="sd">            #or</span>
<span class="sd">            Max = axis total</span>

<span class="sd">        2. Determination of the data (without a buffer) for use in re-applying data back to the original shape of the data.::</span>

<span class="sd">            BMin = 0 #(for tiles on the upper or right borders)</span>
<span class="sd">            #or</span>
<span class="sd">            BMin = (chunk \* index)</span>
<span class="sd">            BMax = chunk \* (inex + 1)</span>
<span class="sd">            #or</span>
<span class="sd">            BMax = axis total</span>

<span class="sd">        3. Determination of where the data (without a buffer) lies within an interpolated tile (with a buffer).::</span>

<span class="sd">            IMin = 0</span>
<span class="sd">            #or</span>
<span class="sd">            IMin = BMin - Min</span>
<span class="sd">            ma = Max - BMin</span>
<span class="sd">            #or</span>
<span class="sd">            ma = axis total</span>
<span class="sd">            if ma == 0:</span>
<span class="sd">                IMax = chunk + buffer</span>
<span class="sd">            if ma != 0:</span>
<span class="sd">                IMax = -(yma)</span>


<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; tiles, chunkGrid, sliceInfo = sliceFinder(20, .5, [25710,35010])</span>
<span class="sd">        &gt;&gt;&gt; print(tiles)</span>
<span class="sd">        36 # 36 Total Tiles</span>
<span class="sd">        &gt;&gt;&gt; print(chunkGrid)</span>
<span class="sd">        array([[ 0,  1,  2,  3,  4,  5],</span>
<span class="sd">               [ 6,  7,  8,  9, 10, 11],</span>
<span class="sd">               [12, 13, 14, 15, 16, 17],</span>
<span class="sd">               [18, 19, 20, 21, 22, 23],</span>
<span class="sd">               [24, 25, 26, 27, 28, 29],</span>
<span class="sd">               [30, 31, 32, 33, 34, 35]])</span>
<span class="sd">        # Tile 3 is index [0,3] and has a value of 2</span>
<span class="sd">        &gt;&gt;&gt; print(sliceInfo)</span>
<span class="sd">        [40.0, 4285, 5835]</span>

<span class="sd">        For a shape of::</span>

<span class="sd">            [25710,35010]</span>
<span class="sd">            (4285, 5835)</span>

<span class="sd">        Tile 1 of 36::</span>

<span class="sd">            chunkSlice = [0,0]</span>
<span class="sd">            [0, 4325, 0, 5875]</span>
<span class="sd">            [0, 4285, 0, 5835]</span>
<span class="sd">            [0, -40, 0, -40]</span>

<span class="sd">        Tile 8 of 36::</span>

<span class="sd">            chunkSlice = [1,2]</span>
<span class="sd">            [4245, 8610, 5795, 11710]</span>
<span class="sd">            [4285, 8570, 5835, 11670]</span>
<span class="sd">            [40, -40, 40, -40]</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yMin</span> <span class="o">=</span> <span
            class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span
            class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">yChunk</span> <span
            class="o">*</span> <span class="n">chunkSlice</span><span class="p">[</span><span class="mi">0</span><span
            class="p">])</span> <span class="o">-</span> <span class="n">buffer</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yMax</span> <span class="o">=</span> <span
            class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span
            class="n">yChunk</span> <span class="o">*</span> <span class="p">(</span><span
            class="n">chunkSlice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span
            class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span
            class="n">buffer</span><span class="p">,</span> <span class="n">shape</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xMin</span> <span class="o">=</span> <span
            class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span
            class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">xChunk</span> <span
            class="o">*</span> <span class="n">chunkSlice</span><span class="p">[</span><span class="mi">1</span><span
            class="p">])</span> <span class="o">-</span> <span class="n">buffer</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xMax</span> <span class="o">=</span> <span
            class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span
            class="n">xChunk</span> <span class="o">*</span> <span class="p">(</span><span
            class="n">chunkSlice</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span
            class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span
            class="n">buffer</span><span class="p">,</span> <span class="n">shape</span><span class="p">[</span><span
            class="mi">1</span><span class="p">]))</span>
        <span class="n">slices</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span
            class="o">.</span><span class="n">yMin</span><span class="p">,</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">yMax</span><span class="p">,</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">xMin</span><span class="p">,</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">xMax</span><span class="p">]</span>

        <span class="c1">## 2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yBMin</span> <span class="o">=</span> <span
            class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span
            class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">yChunk</span> <span
            class="o">*</span> <span class="n">chunkSlice</span><span class="p">[</span><span class="mi">0</span><span
            class="p">])))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yBMax</span> <span class="o">=</span> <span
            class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span
            class="n">yChunk</span> <span class="o">*</span> <span class="p">(</span><span
            class="n">chunkSlice</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span
            class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">shape</span><span
            class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xBMin</span> <span class="o">=</span> <span
            class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span
            class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">xChunk</span> <span
            class="o">*</span> <span class="n">chunkSlice</span><span class="p">[</span><span class="mi">1</span><span
            class="p">])))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xBMax</span> <span class="o">=</span> <span
            class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span
            class="n">xChunk</span> <span class="o">*</span> <span class="p">(</span><span
            class="n">chunkSlice</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span
            class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">shape</span><span
            class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">tiles</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span
            class="o">.</span><span class="n">yBMin</span><span class="p">,</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">yBMax</span><span class="p">,</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">xBMin</span><span class="p">,</span> <span class="bp">self</span><span
            class="o">.</span><span class="n">xBMax</span><span class="p">]</span>

        <span class="c1">## 3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yIMin</span> <span class="o">=</span> <span
            class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span
            class="mi">0</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span
            class="n">yBMin</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span
            class="n">yMin</span><span class="p">)))</span>
        <span class="n">yma</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
            class="nb">min</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span
            class="n">yMax</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span
            class="n">yBMax</span><span class="p">),</span> <span class="n">shape</span><span class="p">[</span><span
            class="mi">0</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">yma</span> <span class="o">==</span> <span class="mi">0</span><span
            class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yIMax</span> <span
            class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">yChunk</span> <span
            class="o">+</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yIMax</span> <span
            class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span
            class="n">yma</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xIMin</span> <span class="o">=</span> <span
            class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span
            class="mi">0</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span
            class="n">xBMin</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span
            class="n">xMin</span><span class="p">)))</span>
        <span class="n">xma</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
            class="nb">min</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span
            class="n">xMax</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span
            class="n">xBMax</span><span class="p">),</span> <span class="n">shape</span><span class="p">[</span><span
            class="mi">1</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">xma</span> <span class="o">==</span> <span class="mi">0</span><span
            class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xIMax</span> <span
            class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xChunk</span> <span
            class="o">+</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xIMax</span> <span
            class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span
            class="n">xma</span><span class="p">)</span>
        <span class="n">borders</span> <span class="o">=</span> <span class="p">[</span><span
            class="bp">self</span><span class="o">.</span><span class="n">yIMin</span><span class="p">,</span> <span
            class="bp">self</span><span class="o">.</span><span class="n">yIMax</span><span class="p">,</span> <span
            class="bp">self</span><span class="o">.</span><span class="n">xIMin</span><span class="p">,</span> <span
            class="bp">self</span><span class="o">.</span><span class="n">xIMax</span><span class="p">]</span>

        <span class="nb">print</span> <span class="p">(</span><span class="n">slices</span><span
            class="p">,</span> <span class="n">tiles</span><span class="p">,</span> <span class="n">borders</span><span
            class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span
            class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div></div>
</pre>
                </div>

            </div>
        </div>
    </div>
    <div aria-label="main navigation" class="sphinxsidebar" role="navigation">
        <div class="sphinxsidebarwrapper">
            <div id="searchbox" role="search" style="display: none">
                <h3>Quick search</h3>
                <form action="../search.html" class="search" method="get">
                    <div><input name="q" type="text"/></div>
                    <div><input type="submit" value="Go"/></div>
                    <input name="check_keywords" type="hidden" value="yes"/>
                    <input name="area" type="hidden" value="default"/>
                </form>
            </div>
            <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
    </div>
    <div class="clearer"></div>
</div>
<div aria-label="related navigation" class="related" role="navigation">
    <h3>Navigation</h3>
    <ul>
        <li class="right" style="margin-right: 10px">
            <a href="../genindex.html" title="General Index"
            >index</a></li>
        <li class="right">
            <a href="../py-modindex.html" title="Python Module Index"
            >modules</a> |
        </li>
        <li class="nav-item nav-item-0"><a href="../index.html">autointerp documentation</a> &#187;</li>
        <li class="nav-item nav-item-1"><a href="index.html">Module code</a> &#187;</li>
    </ul>
</div>
<div class="footer" role="contentinfo">
    &#169; Copyright .
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.3.
</div>
</body>
</html>